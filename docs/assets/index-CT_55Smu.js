import{l as ve,c as $,b as m,d as u,J as _,q as P,g as d,F as N,j as J,i as K,e as W,f as oe,w as z,A as se,K as Ee,y as j,H as ge,L as V,M as R,T as he,t as F,r as te,x as fe,o as ke,N as $e,m as Me,D as Ce,I as _e,n as ee,h as Ye,z as re,O as Pe,P as Ae,Q as Ve,R as Re,S as Fe}from"./index-Cl9n6jGj.js";import{w as pe,m as ne,p as ce,c as Ie,d as Le,e as He}from"./index-Bm4pAF05.js";const We=24*60,je={allDayEvents:{type:[Boolean,String],default:!1},clickToNavigate:{type:Boolean,default:void 0},dark:{type:Boolean,default:!1},datePicker:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},editableEvents:{type:[Boolean,Object],default:!1},eventCreateMinDrag:{type:Number,default:15},events:{type:Array,default:()=>[]},eventCount:{type:Boolean,default:!1},eventsOnMonthView:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:String,default:""},maxDate:{type:[String,Date],default:""},minDate:{type:[String,Date],default:""},selectedDate:{type:[String,Date],default:""},sm:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},schedules:{type:Array,default:()=>[]},snapToInterval:{type:Number,default:0},startWeekOnSunday:{type:Boolean,default:!1},theme:{type:[String,Boolean],default:"default"},time:{type:Boolean,default:!0},timeAtCursor:{type:Boolean,default:!1},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:We},titleBar:{type:Boolean,default:!0},todayButton:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},view:{type:String,default:""},viewDate:{type:[String,Date],default:""},viewDayOffset:{type:Number,default:0},views:{type:[Array,Object]},viewsBar:{type:Boolean,default:!0},watchRealTime:{type:Boolean,default:!1},weekNumbers:{type:Boolean,default:!1},xs:{type:Boolean,default:!1}},Ue={class:"vuecal__header"},qe={key:0,class:"vuecal__views-bar"},Ge=["onClick","innerHTML"],Je={key:1,class:"vuecal__title-bar"},Ke={class:"vuecal__transition-wrap"},Qe=["disabled","innerHTML"],Ze={__name:"header",setup(L){const b=ve("vuecal"),{view:l,config:n}=b,o=()=>{n.clickToNavigate&&l.broader()},y=$(()=>n.clickToNavigate?{click:o}:{});return(Y,g)=>(u(),m("div",Ue,[_(Y.$slots,"header",{view:d(l),availableViews:d(n).availableViews,vuecal:d(b)}),Y.$slots.header?P("",!0):(u(),m(N,{key:0},[d(n).viewsBar?(u(),m("div",qe,[(u(!0),m(N,null,J(d(n).availableViews,(k,t)=>(u(),m("button",{class:K(["vuecal__view-button",{"vuecal__view-button--active":d(l).id===t}]),onClick:s=>d(l).switch(t),innerHTML:d(b).texts[t],type:"button"},null,10,Ge))),256))])):P("",!0),d(n).titleBar?(u(),m("nav",Je,[W("button",{class:K(["vuecal__nav vuecal__nav--prev",{"vuecal__nav--default":!Y.$slots["previous-button"]}]),onClick:g[0]||(g[0]=(...k)=>d(l).previous&&d(l).previous(...k)),type:"button"},[_(Y.$slots,"previous-button")],2),W("div",Ke,[oe(he,{name:`vuecal-slide-fade--${d(l).transitionDirection}`},{default:z(()=>[(u(),m("div",{key:d(l).id+d(l).start.getTime()},[Y.$slots.title?(u(),se(Ee(d(n).clickToNavigate&&d(l).broaderView?"button":"div"),j({key:0,class:"vuecal__title"},ge(y.value)),{default:z(()=>[_(Y.$slots,"title",V(R(d(l))))]),_:3},16)):(u(),se(Ee(d(n).clickToNavigate&&d(l).broaderView?"button":"div"),j({key:1,class:"vuecal__title"},ge(y.value),{innerHTML:d(l).title}),null,16,["innerHTML"]))]))]),_:3},8,["name"])]),d(n).todayButton?(u(),m(N,{key:0},[Y.$slots["today-button"]?_(Y.$slots,"today-button",{key:0,navigate:()=>!d(l).containsToday&&d(l).goToToday(),active:d(l).containsToday}):(u(),m("button",{key:1,class:K(["vuecal__nav vuecal__nav--today vuecal__nav--default",{"vuecal__nav--active":d(l).containsToday}]),onClick:g[1]||(g[1]=k=>!d(l).containsToday&&d(l).goToToday()),disabled:!!d(l).containsToday,type:"button",innerHTML:d(b).texts.today},null,10,Qe))],64)):P("",!0),W("button",{class:K(["vuecal__nav vuecal__nav--next",{"vuecal__nav--default":!Y.$slots["next-button"]}]),onClick:g[2]||(g[2]=(...k)=>d(l).next&&d(l).next(...k)),type:"button"},[_(Y.$slots,"next-button")],2)])):P("",!0)],64))]))}},xe={key:0,class:"vuecal__headings"},et={key:0,class:"vuecal__weekdays-headings"},tt=["onClick"],st={class:"vuecal__weekday-day"},at={key:0,class:"vuecal__weekday-date"},lt={key:1,class:"vuecal__schedules-headings w-flex grow"},nt=["innerHTML"],ot={__name:"headings-bar",setup(L){const b=ve("vuecal"),{view:l,config:n,dateUtils:o}=b,y=$(()=>n.xs?"day-xs":n.sm||l.isDays||l.isMonth?"day-sm":"day"),Y=$(()=>(l.isDay||l.isDays||l.isWeek||l.isMonth)&&!(l.isDay&&!n.schedules)),g=$(()=>l.cellDates.slice(0,l.cols).map(({start:t})=>({id:pe[t.getDay()],date:t,dateNumber:t.getDate(),day:o.formatDate(t,"dddd"),"day-sm":o.formatDate(t,"ddd"),"day-xs":o.formatDate(t,"dd"),isToday:o.isToday(t)}))),k={click:t=>{(l.isDays||l.isWeek)&&l.updateSelectedDate(t)}};return(t,s)=>Y.value?(u(),m("div",xe,[d(l).isDay?P("",!0):(u(),m("div",et,[(u(!0),m(N,null,J(g.value,(w,B)=>(u(),m("div",{class:K(["vuecal__weekday",{"vuecal__weekday--today":w.isToday}]),key:B,onClick:X=>k.click(w.date)},[_(t.$slots,"weekday-heading",{label:w[y.value],id:w.id,date:w.date},()=>[W("span",st,F(w[y.value]),1),d(l).isMonth?P("",!0):(u(),m("strong",at,F(w.dateNumber),1))])],10,tt))),128))])),d(n).schedules?(u(),m("div",lt,[(u(!0),m(N,null,J(g.value,(w,B)=>(u(),m(N,{key:B},[(u(!0),m(N,null,J(d(n).schedules,(X,H)=>(u(),m(N,{key:H},[t.$slots["schedule-heading"]?(u(),m("div",{key:0,class:K(["vuecal__schedule vuecal__schedule--heading",X.class])},[_(t.$slots,"schedule-heading",{schedule:X,view:d(l)})],2)):(u(),m("div",{key:1,class:K(["vuecal__schedule vuecal__schedule--heading",X.class]),innerHTML:X.label},null,10,nt))],64))),128))],64))),128))])):P("",!0)])):P("",!0)}},rt={class:"vuecal__time-column"},it={__name:"time-column",setup(L){const b=ve("vuecal"),{config:l,texts:n}=b,o=$(()=>{const y=[];for(let g=l.timeFrom;g<l.timeTo;g+=l.timeStep){const k=~~(g/60),t=g%60,s=n[g<720?"am":"pm"];y.push({minutesSum:g,hours:k,minutes:t,formatted12:`${k%12?k%12:12}${t?":"+t.toString().padStart(2,0):""}${s}`,formatted24:`${k.toString().padStart(2,0)}:${t.toString().padStart(2,0)}`})}return y});return(y,Y)=>(u(),m("div",rt,[(u(!0),m(N,null,J(o.value,(g,k)=>(u(),m("div",{class:"vuecal__time-cell",key:k},[_(y.$slots,"time-cell",{index:k,minutes:g.minutes,hours:g.hours,minutesSum:g.minutesSum,format12:g.formatted12,format24:g.formatted24},()=>[W("label",null,F(d(l).twelveHour?g.formatted12:g.formatted24),1)])]))),128))]))}},ut=["draggable"],ct={class:"vuecal__event-details"},vt={class:"vuecal__event-title"},dt={key:0,class:"vuecal__event-time"},mt=["innerHTML"],ze={__name:"event",props:{event:{type:Object,required:!0}},emits:["event-drag-start","event-drag-end","event-resize-start","event-resize-end"],setup(L,{emit:b}){const{config:l,view:n,dnd:o,touch:y,dateUtils:Y}=ve("vuecal"),g=L,k=te(null),t=fe(g.event),s=fe({dragging:!1,resizing:!1,fromResizer:!1,holding:!1,holdTimer:null,startX:0,startY:0,startPercentageX:0,startPercentageY:0,moveX:0,moveY:0,movePercentageX:0,movePercentageY:0,resizeStartDate:null,resizingOriginalEvent:null,resizingLastAcceptedEvent:null,cellEl:null,schedule:null}),w=$(()=>l.editableEvents.drag&&t.draggable!==!1&&!t.background),B=$(()=>l.time&&l.editableEvents.resize&&t.resizable!==!1&&!t.background);$(()=>l.editableEvents.delete&&t.deletable!==!1&&!t.background);const X=$(()=>{var h,r,D;return{[`vuecal__event--${t._.id}`]:!0,[t.class]:!!t.class,"vuecal__event--recurring":!!t.recurring,"vuecal__event--background":!!t.background,"vuecal__event--multiday":!!((h=t._)!=null&&h.multiday),"vuecal__event--cut-top":((r=t._)==null?void 0:r.startMinutes)<l.timeFrom,"vuecal__event--cut-bottom":((D=t._)==null?void 0:D.endMinutes)>l.timeTo||t.end.getDate()!==t.start.getDate(),"vuecal__event--dragging":!t._.draggingGhost&&t._.dragging,"vuecal__event--dragging-ghost":t._.draggingGhost,"vuecal__event--resizing":s.resizing}}),H=$(()=>{const h=(n.isDay||n.isDays||n.isWeek)&&l.time;if(!h&&!t.backgroundColor&&!t.color)return!1;const r={backgroundColor:t.backgroundColor||null,color:t.color||null};if(h){const D=Math.max(l.timeFrom,t._.startMinutes),E=Math.min(l.timeTo,t._.endMinutes),C=ne(D,l),S=ne(E,l)-C;r.top=`${C}%`,r.height=`${S}%`}return r}),a=$(()=>{const h={...l.eventListeners.event};Object.entries(h).forEach(([E,C])=>{["resize-end"].includes(E)||(h[E]=S=>{S.type!=="drop"&&C(S.type?{e:S,event:t}:S)})});const r={...h};h.touchstart=E=>{var C;E.stopPropagation(),(C=r.touchstart)==null||C.call(r,{e:E,event:t})},h.mousedown=E=>{var C;E.stopPropagation(),v(E),(C=r.mousedown)==null||C.call(r,{e:E,event:t})};let D=null;return h.click=E=>{var C;(C=r.click)==null||C.call(r,{e:E,event:t}),D?D=clearTimeout(D):D=setTimeout(()=>{var S;D=null,(S=r["delayed-click"])==null||S.call(r,{e:E,event:t})},400)},h.dblclick=E=>{r.dblclick?r.dblclick({e:E,event:t}):t.delete(1)},h}),v=h=>{var E,C,S;const r=((E=h.touches)==null?void 0:E[0])||h;s.fromResizer=r.target.matches(".vuecal__event-resizer, .vuecal__event-resizer *");const D=k.value.getBoundingClientRect();s.startX=(((C=h.touches)==null?void 0:C[0])||h).clientX-D.left,s.startY=(((S=h.touches)==null?void 0:S[0])||h).clientY-D.top,s.startPercentageX=s.startX*100/D.width,s.startPercentageY=s.startY*100/D.height,s.cellEl=k.value.closest(".vuecal__cell"),s.resizeStartDate=t.start,de(h.type==="touchstart"?"touchmove":"mousemove",U),de(h.type==="touchstart"?"touchend":"mouseup",p,{once:!0}),s.holdTimer=setTimeout(()=>{var O,q;s.holding=!0,(q=(O=a.value).hold)==null||q.call(O,{e:h,event:t})},1e3)},U=async h=>{var D,E,C,S;const r=((D=h.touches)==null?void 0:D[0])||h;if(s.fromResizer&&!s.resizing&&(s.resizing=!0,s.resizingOriginalEvent={...t,_:{...t._}},y.isResizingEvent=!0,(C=(E=a.value).resizeStart)==null||C.call(E,{e:h,event:t})),s.holdTimer=clearTimeout(s.holdTimer),s.holding=!1,s.cellEl){const{top:O,left:q,width:ae,height:Q}=s.cellEl.getBoundingClientRect();s.moveX=r.clientX-q,s.moveY=r.clientY-O,s.movePercentageX=s.moveX*100/ae,s.movePercentageY=s.moveY*100/Q}if(s.fromResizer){const{newStart:O,newEnd:q}=ie(t);let ae=!0;const{resize:Q}=(S=l.eventListeners)==null?void 0:S.event;Q&&(ae=await Q({e:h,event:{...t,start:O,end:q},overlaps:t.getOverlappingEvents({start:O,end:q})})),ae!==!1?(t.start=O,t.end=q,s.resizingLastAcceptedEvent&&(s.resizingLastAcceptedEvent=null)):Q&&(s.resizingLastAcceptedEvent={...t,_:{...t._}})}},p=async h=>{var r,D;if(s.holdTimer=clearTimeout(s.holdTimer),s.holding=!1,s.resizing){const{newStart:E,newEnd:C}=ie(t);let S=!0;const O=a.value["resize-end"];O&&(S=await O({e:h,event:t,original:s.resizingOriginalEvent,overlaps:t.getOverlappingEvents({start:E,end:C})})),t.start=S===!1?(s.resizingLastAcceptedEvent||s.resizingOriginalEvent).start:((r=s.resizingLastAcceptedEvent)==null?void 0:r.start)||E,t.end=S===!1?(s.resizingLastAcceptedEvent||s.resizingOriginalEvent).end:((D=s.resizingLastAcceptedEvent)==null?void 0:D.end)||C,t._.duration<1&&(t.start=s.resizingOriginalEvent.start,t.end=s.resizingOriginalEvent.end),y.isResizingEvent=!1}document.removeEventListener(h.type==="touchend"?"touchmove":"mousemove",U),s.resizing=!1,s.fromResizer=!1,s.dragging=!1,s.startX=0,s.startY=0,s.moveX=0,s.moveY=0,s.startPercentageX=0,s.startPercentageY=0,s.movePercentageX=0,s.movePercentageY=0,s.cellEl=null,s.resizeStartDate=null,s.resizingOriginalEvent=null,s.resizingLastAcceptedEvent=null,s.schedule=null},ie=h=>{const r=new Date(h.start.getFullYear(),h.start.getMonth(),h.start.getDate());new Date(r).setDate(r.getDate()+1);let E=ce(s.movePercentageY,l);if(E=Math.max(0,Math.min(E,24*60)),l.snapToInterval){const O=E+l.snapToInterval/2;E=O-O%l.snapToInterval}let C=h.start,S=new Date(r.getTime()+E*6e4);return S<s.resizeStartDate&&(C=S,S=s.resizeStartDate),{newStart:C,newEnd:S}};ke(()=>t._.register(k.value));const me=[],de=(h,r,D)=>{document.addEventListener(h,r,D),me.push({event:h,handler:r,options:D})};return $e(()=>{t._.unregister(),me.forEach(({event:h,handler:r,options:D})=>{document.removeEventListener(h,r,D)})}),(h,r)=>(u(),m("div",j({class:"vuecal__event"},ge(a.value,!0),{ref_key:"eventEl",ref:k,class:X.value,style:H.value,draggable:w.value?"true":void 0,onDragstart:r[2]||(r[2]=D=>w.value&&d(o).eventDragStart(D,t)),onDragend:r[3]||(r[3]=D=>w.value&&d(o).eventDragEnd(D,t))}),[W("div",ct,[_(h.$slots,"event",{event:t},()=>[W("div",vt,F(t.title),1),d(l).time?(u(),m("div",dt,F(t._[`startTimeFormatted${d(l).twelveHour?12:24}`])+`
- `+F(t._[`endTimeFormatted${d(l).twelveHour?12:24}`]),1)):P("",!0),W("div",{class:"vuecal__event-content",innerHTML:t.content},null,8,mt)])]),B.value?(u(),m("div",{key:0,class:"vuecal__event-resizer",onDragstart:r[0]||(r[0]=Me(()=>{},["prevent","stop"]))},null,32)):P("",!0),oe(he,{name:"vuecal-delete-btn"},{default:z(()=>[t._.deleting?(u(),m("div",{key:0,class:"vuecal__event-delete",onClick:r[1]||(r[1]=Me(D=>t.delete(3),["stop"]))},"Delete")):P("",!0)]),_:1})],16,ut))}},gt=["innerHTML"],ft=["data-schedule"],ht={key:1,class:"vuecal__cell-date"},yt={key:2,class:"vuecal__cell-content"},_t={key:3,class:"vuecal__cell-events"},pt={key:1,class:"vuecal__cell-date"},kt={key:2,class:"vuecal__cell-content"},$t={key:3,class:"vuecal__cell-events"},wt={key:5,class:"vuecal__cell-events-count"},bt=["title"],Dt={__name:"cell",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},index:{type:Number,required:!0}},setup(L){const b=L,l=ve("vuecal"),{view:n,config:o,dateUtils:y,eventsManager:Y,dnd:g,touch:k}=l,t=$(()=>y.isToday(b.start)),s=te(null),w=te([]),B=te(!1),X=e=>{w.value.push(e.detail),B.value=!0},H=()=>setTimeout(()=>B.value=!1,300),a=fe({dragging:!1,holding:!1,holdTimer:null,thresholdPassed:!1,startX:0,startY:0,moveX:0,moveY:0,startPercentageX:0,startPercentageY:0,movePercentageX:0,movePercentageY:0,schedule:null}),v=te(!1),U=te({cellOverlaps:{},longestStreak:0}),p=$(()=>{let e=Math.min(a.startPercentageY,a.movePercentageY),i=Math.max(a.startPercentageY,a.movePercentageY),f=ce(e,o),c=ce(i,o);return o.snapToInterval&&(f=y.snapToInterval(f,o.snapToInterval),c=y.snapToInterval(c,o.snapToInterval),e=ne(f,o),i=ne(c,o)),{style:{top:e+"%",height:Math.abs(i-e)+"%"},startMinutes:f,endMinutes:c,start:y.formatMinutes(f),end:y.formatMinutes(c),...a.schedule?{schedule:a.schedule}:{}}}),ie=$(()=>{const e=o.editableEvents.create&&(a.dragging||v.value),i=o.eventCreateMinDrag&&a.thresholdPassed||!o.eventCreateMinDrag;return e&&i}),me=$(()=>{var A;const e=new Date,i=n.start.getFullYear(),f=n.start.getMonth(),c=b.start.getFullYear(),T=b.start.getMonth();return{[`vuecal__cell--${pe[b.start.getDay()]}`]:n.isDay||n.isDays||n.isWeek||n.isMonth,[`vuecal__cell--${Ie[T]}`]:n.isYear,[`vuecal__cell--${c}`]:n.isYears,"vuecal__cell--today":t.value,"vuecal__cell--current-month":n.isYear&&c===e.getFullYear()&&T===e.getMonth(),"vuecal__cell--current-year":n.isYears&&c===e.getFullYear(),"vuecal__cell--out-of-range":n.isMonth&&(c!==i||T!==f),"vuecal__cell--before-min":Q.value&&q.value,"vuecal__cell--after-max":Q.value&&ae.value,"vuecal__cell--disabled":Q.value,"vuecal__cell--selected":n.selectedDate&&n.selectedDate.getTime()>=b.start.getTime()&&n.selectedDate.getTime()<=b.end.getTime(),"vuecal__cell--has-schedules":(A=o.schedules)==null?void 0:A.length,"vuecal__cell--dragging":a.dragging,"vuecal__cell--has-events":r.value.length}}),de=$(()=>y.formatDate(b.start)),h=$(()=>{switch(n.id){case"day":return"";case"days":return o.availableViews.days.rows>1&&y.formatDate(b.start,"D"),"";case"week":return"";case"month":return y.formatDate(b.start,"D");case"year":return y.formatDate(b.start,o.xs?"MMM":"MMMM");case"years":return y.formatDate(b.start,"YYYY")}}),r=$(()=>o.datePicker?[]:Y.getEventsByDate(de.value,!0,!0).filter(e=>!w.value.includes(e._.id))),D=$(()=>r.value.filter(e=>!e.background)),E=$(()=>{var e;return(e=o.schedules)==null?void 0:e.reduce((i,f)=>(i[f.id]=r.value.filter(c=>c.schedule===f.id),i),{})}),C=$(()=>{const e={};for(const i of r.value){const f=i._.id,{maxConcurrent:c=1,position:T=0}=U.value.cellOverlaps[f]||{};e[f]={width:`${100/c}%`,left:`${100/c*T}%`}}return e}),S=$(()=>n.isMonth&&o.eventCount&&!o.eventsOnMonthView&&D.value.length),O=$(()=>{var f;if(!o.specialHours||n.isMonth||n.isYear||n.isYears)return;const e=pe[b.start.getDay()];let i=(f=o.specialHours)==null?void 0:f[e];if(i)return Array.isArray(i)||(i=[i]),i.map(c=>{let{from:T,to:M,class:A,label:G}=c;if(isNaN(T)||isNaN(M)||o.timeFrom>=M||o.timeTo<=T)return;T=Math.max(o.timeFrom,T),M=Math.min(o.timeTo,M);const x=ne(T,o),ye=ne(M,o)-x;return{style:{top:`${x}%`,height:`${ye}%`},label:G,class:A}}).filter(c=>!!c)}),q=$(()=>o.minTimestamp!==null&&o.minTimestamp>b.end.getTime()),ae=$(()=>o.maxTimestamp&&o.maxTimestamp<b.start.getTime()),Q=$(()=>{const{disableDays:e}=o,i=n.isYear||n.isYears;return e.length&&e.includes(y.formatDate(b.start))&&!i?!0:q.value||ae.value}),ue=fe({show:$(()=>{if(!(!n.isDay&&!n.isDays&&!n.isWeek)&&!(!t.value||!o.time)&&!(o.timeFrom>y.dateToMinutes(n.now))&&!(y.dateToMinutes(n.now)>o.timeTo))return!0}),nowInMinutes:$(()=>y.dateToMinutes(n.now)),todaysTimePosition:$(()=>ne(ue.nowInMinutes,o)),style:$(()=>`top: ${ue.todaysTimePosition}%`),currentTime:$(()=>y.formatTime(n.now))}),le=$(()=>{if(Q.value)return{};const e={...o.eventListeners.cell};Object.entries(e).forEach(([c,T])=>{e[c]=M=>{var A,G,x;(x=(G=M.target||((A=M.e)==null?void 0:A.target)).closest)!=null&&x.call(G,".vuecal__event")||T(M.type?{e:M,cell:I.value,cursor:Z.value}:M)}});const i={...e};let f=null;return e.click=c=>{var T;Se(),(T=i.click)==null||T.call(i,{e:c,cell:I.value,cursor:Z.value}),f?f=clearTimeout(f):f=setTimeout(()=>{var M;f=null,(M=i["delayed-click"])==null||M.call(i,{e:c,cell:I.value,cursor:Z.value})},400)},(o.time&&n.isDay||n.isDays||n.isWeek)&&(e.touchstart=c=>{var T;we(c.e||c),(T=i.touchstart)==null||T.call(i,{e:c,cell:I.value,cursor:Z.value})},e.mousedown=c=>{var T;we(c.e||c),(T=i.mousedown)==null||T.call(i,{e:c,cell:I.value,cursor:Z.value})}),i.dblclick&&(e.dblclick=c=>{var De,Te;const T=(((De=c.touches)==null?void 0:De[0])||c).clientY,{top:M}=s.value.getBoundingClientRect(),A=Le(T-M,s.value),G=ce(A,o),x=new Date(b.start);x.setMinutes(G);const ye={y:A,date:x};(Te=i.dblclick)==null||Te.call(i,{e:c,cell:I.value,cursor:ye})}),o.editableEvents.drag&&(e.dragenter=c=>g.cellDragEnter(c,I.value),e.dragover=c=>{c.preventDefault(),g.cellDragOver(c,I.value)},e.dragleave=c=>g.cellDragLeave(c,I.value),e.drop=c=>g.cellDragDrop(c,I.value)),e}),I=$(()=>({start:b.start,end:b.end,events:r,...a.schedule?{schedule:a.schedule}:{}})),Z=$(()=>{const e=ce(a.movePercentageY||a.startPercentageY,o),i=new Date(b.start);return i.setMinutes(e),{x:a.movePercentageX||a.startPercentageX,y:a.movePercentageY||a.startPercentageY,date:i}}),Se=()=>{n.updateSelectedDate(b.start),o.clickToNavigate&&((n.isMonth||n.isDays||n.isWeek)&&o.availableViews.day?n.switch("day"):n.isYear&&o.availableViews.month?n.switch("month"):n.isYears&&o.availableViews.year&&n.switch("year")),n.updateViewDate(b.start)},we=e=>{var f,c;a.schedule=~~e.target.dataset.schedule;const i=s.value.getBoundingClientRect();a.startX=(((f=e.touches)==null?void 0:f[0])||e).clientX-i.left,a.startY=(((c=e.touches)==null?void 0:c[0])||e).clientY-i.top,a.startPercentageX=a.startX*100/i.width,a.startPercentageY=a.startY*100/i.height,a.thresholdPassed=!1,document.addEventListener(e.type==="touchstart"?"touchmove":"mousemove",be),document.addEventListener(e.type==="touchstart"?"touchend":"mouseup",Be,{once:!0}),a.holdTimer=setTimeout(()=>{var T,M;a.holding=!0,(M=(T=le.value).hold)==null||M.call(T,{e,cell:I.value,cursor:Z.value})},1e3)},be=e=>{var f,c,T,M,A,G;a.dragging||(k.isDraggingCell=!0,(c=(f=le.value).dragStart)==null||c.call(f,{e,cell:I.value,cursor:Z.value})),a.dragging=!0,a.holdTimer=clearTimeout(a.holdTimer),a.holding=!1;const i=s.value.getBoundingClientRect();a.moveX=(((T=e.touches)==null?void 0:T[0])||e).clientX-i.left,a.moveY=(((M=e.touches)==null?void 0:M[0])||e).clientY-i.top,a.movePercentageX=a.moveX*100/i.width,a.movePercentageY=a.moveY*100/i.height,o.eventCreateMinDrag&&Math.abs(a.startY-a.moveY)>o.eventCreateMinDrag&&(a.thresholdPassed=!0),(G=(A=le.value).drag)==null||G.call(A,{e,cell:I.value,cursor:Z.value})},Be=async e=>{var i,f;document.removeEventListener(e.type==="touchend"?"touchmove":"mousemove",be,{passive:!1}),a.dragging&&((f=(i=le.value).dragEnd)==null||f.call(i,{e,cell:I.value,cursor:Z.value}),k.isDraggingCell=!1,o.editableEvents.create&&(v.value=!0,await Xe(e),v.value=!1)),a.holdTimer=clearTimeout(a.holdTimer),a.holding=!1,a.dragging=!1,a.startX=0,a.startY=0,a.moveX=0,a.moveY=0,a.startPercentageX=0,a.startPercentageY=0,a.movePercentageX=0,a.movePercentageY=0,a.thresholdPassed=!1,a.schedule=null},Xe=async e=>{if(!ie.value)return;let{start:i,end:f,startMinutes:c,endMinutes:T}=p.value;i=new Date(b.start),i.setMinutes(c),f=new Date(b.start),f.setMinutes(T);let M={...p.value,start:i,end:f};const{create:A}=o.eventListeners.event;if(typeof A=="function"){const G=M;M=await new Promise(x=>A({e,event:M,cell:I.value,resolve:x,cursor:Z.value})),M&&typeof M=="object"&&n.createEvent(M),M&&typeof M=="boolean"&&n.createEvent(G)}else n.createEvent(M)},Oe=()=>{Object.keys(le.value).forEach(e=>{var i;(i=s.value)==null||i.removeEventListener(e,le.value[e])})},Ne=()=>{U.value=Y.getCellOverlappingEvents(de.value)};return Ce(()=>D.value.map(e=>`${e._.id}${e.start.getTime()}${e.end.getTime()}`).join(),async()=>{await _e(),Ne()},{immediate:!0,flush:"post"}),$e(async()=>{w.value.forEach(e=>Y.deleteEvent(e,3)),Oe(),await _e()}),(e,i)=>(u(),m("div",j({class:["vuecal__cell",me.value],ref_key:"cellEl",ref:s},ge(le.value,!0)),[e.$slots.cell?_(e.$slots,"cell",{key:0,start:L.start,end:L.end,index:L.index,events:r.value}):P("",!0),O.value?(u(!0),m(N,{key:1},J(O.value,(f,c)=>(u(),m("div",{class:K(["vuecal__special-hours",f.class]),style:ee(f.style),innerHTML:f.label||""},null,14,gt))),256)):P("",!0),!e.$slots.cell&&d(o).schedules?(u(!0),m(N,{key:2},J(d(o).schedules,f=>(u(),m("div",{class:K(["vuecal__schedule vuecal__schedule--cell",f.class]),key:f.id,style:ee(f.style||null),"data-schedule":f.id},[e.$slots["cell-events"]?_(e.$slots,"cell-events",{key:0,start:L.start,end:L.end,events:r.value}):P("",!0),h.value||e.$slots["cell-date"]?(u(),m("div",ht,[_(e.$slots,"cell-date",{start:L.start,end:L.end,events:r.value},()=>[Ye(F(h.value),1)])])):P("",!0),e.$slots["cell-content"]?(u(),m("div",yt,[_(e.$slots,"cell-content",{start:L.start,end:L.end,events:r.value})])):P("",!0),e.$slots["cell-events"]&&r.value.length?(u(),m("div",_t,[_(e.$slots,"cell-events",{start:L.start,end:L.end,events:r.value})])):r.value.length||B.value?(u(),se(Pe,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:i[0]||(i[0]=c=>B.value=!0),onAfterLeave:H,tag:"div"},{default:z(()=>[(u(!0),m(N,null,J(E.value[f.id],c=>(u(),se(ze,{key:c._.id,event:c,onEventDeleted:X,style:ee(C.value[c._.id])},re({_:2},[e.$slots.event?{name:"event",fn:z(T=>[_(e.$slots,"event",j({ref_for:!0},T))]),key:"0"}:void 0]),1032,["event","style"]))),128))]),_:2},1024)):P("",!0),ie.value&&a.schedule===f.id?(u(),m("div",{key:5,class:"vuecal__event-placeholder",style:ee(p.value.style)},F(p.value.start)+" - "+F(p.value.end),5)):P("",!0)],14,ft))),128)):P("",!0),!e.$slots.cell&&!d(o).schedules?(u(),m(N,{key:3},[e.$slots["cell-events"]?_(e.$slots,"cell-events",{key:0}):P("",!0),h.value||e.$slots["cell-date"]?(u(),m("div",pt,[_(e.$slots,"cell-date",{start:L.start,end:L.end,events:r.value},()=>[Ye(F(h.value),1)])])):P("",!0),e.$slots["cell-content"]?(u(),m("div",kt,[_(e.$slots,"cell-content",{start:L.start,end:L.end,events:r.value})])):P("",!0),e.$slots["cell-events"]&&r.value.length?(u(),m("div",$t,[_(e.$slots,"cell-events",{start:L.start,end:L.end,events:r.value})])):(r.value.length||B.value)&&!(d(n).isMonth&&!d(o).eventsOnMonthView)?(u(),se(Pe,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:i[1]||(i[1]=f=>B.value=!0),onAfterLeave:H,tag:"div"},{default:z(()=>[(u(!0),m(N,null,J(r.value,f=>(u(),se(ze,{key:f._.id,event:f,onEventDeleted:X,style:ee(C.value[f._.id])},re({_:2},[e.$slots.event?{name:"event",fn:z(c=>[_(e.$slots,"event",j({ref_for:!0},c))]),key:"0"}:void 0]),1032,["event","style"]))),128))]),_:3})):P("",!0),ie.value?(u(),m("div",{key:5,class:"vuecal__event-placeholder",style:ee(p.value.style)},F(p.value.start)+" - "+F(p.value.end),5)):P("",!0)],64)):P("",!0),e.$slots["event-count"]?_(e.$slots,"event-count",{key:4,events:D.value}):S.value?(u(),m("div",wt,F(D.value.length),1)):P("",!0),ue.show?(u(),m("div",{key:6,class:"vuecal__now-line",style:ee(ue.style),title:ue.currentTime},[W("span",null,F(ue.currentTime),1)],12,bt)):P("",!0)],16))}},Tt={__name:"body",setup(L){const b=ve("vuecal");let{view:l,config:n,dateUtils:o}=b;const y=te(null),Y=te(null),g=$(()=>({"--vuecal-grid-columns":l.cols,"--vuecal-grid-rows":l.rows})),k=$(()=>{const w=o.formatTime(ce(Y.value,n));return{style:{top:Y.value+"%"},time:w}}),t=w=>{var H;if(l.isMonth||l.isYear||l.isYears)return;const B=(((H=w.touches)==null?void 0:H[0])||w).clientY,{top:X}=y.value.getBoundingClientRect();Y.value=Le(B-X,y.value)},s=()=>{Y.value=null};return ke(()=>{y.value.addEventListener("mousemove",t),y.value.addEventListener("touchmove",t),y.value.addEventListener("mouseleave",s),y.value.addEventListener("touchend",s)}),$e(()=>{y.value&&(y.value.removeEventListener("mousemove",t),y.value.removeEventListener("touchmove",t),y.value.removeEventListener("mouseleave",s),y.value.removeEventListener("touchend",s))}),(w,B)=>(u(),m("div",{class:"vuecal__body",ref_key:"bodyEl",ref:y,style:ee(g.value)},[oe(he,{name:"vuecal-shrink"},{default:z(()=>[d(n).timeAtCursor&&Y.value!==null?(u(),m("div",{key:0,class:"vuecal__time-at-cursor",style:ee(k.value.style)},[W("label",null,F(k.value.time),1)],4)):P("",!0)]),_:1}),(u(!0),m(N,null,J(d(l).cellDates,(X,H)=>(u(),se(Dt,{key:H,start:X.start,end:X.end,index:H},re({_:2},[w.$slots.cell?{name:"cell",fn:z(a=>[_(w.$slots,"cell",j({ref_for:!0},a))]),key:"0"}:void 0,w.$slots["cell-date"]?{name:"cell-date",fn:z(a=>[_(w.$slots,"cell-date",j({ref_for:!0},a))]),key:"1"}:void 0,w.$slots["cell-content"]?{name:"cell-content",fn:z(a=>[_(w.$slots,"cell-content",j({ref_for:!0},a))]),key:"2"}:void 0,w.$slots["cell-events"]?{name:"cell-events",fn:z(a=>[_(w.$slots,"cell-events",j({ref_for:!0},a))]),key:"3"}:w.$slots.event?{name:"event",fn:z(a=>[_(w.$slots,"event",j({ref_for:!0},a))]),key:"4"}:w.$slots["event-count"]?{name:"event-count",fn:z(a=>[_(w.$slots,"event-count",j({ref_for:!0},a))]),key:"5"}:void 0]),1032,["start","end","index"]))),128))],4))}},Et=["data-locale"],Mt={class:"vuecal__scrollable-wrap"},Yt={key:1,class:"vuecal__week-numbers"},Pt={class:"vuecal__week-number"},zt={class:"vuecal__body-wrap"},St={__name:"index",props:je,emits:["ready","view-change","update:view","update:selectedDate","update:viewDate","update:events","event-delete","event-created","event-dropped","event-change"],setup(L,{expose:b,emit:l}){const n=L,o=l,y=Ae("vuecal-el"),Y=He({props:n,emit:o,attrs:Re(),vuecalEl:y,uid:Ve()}),{config:g,view:k,dateUtils:t,touch:s}=Y,w=$(()=>g.time&&(k.isDay||k.isDays||k.isWeek)),B=$(()=>Array(k.rows).fill().map((v,U)=>t.getWeek(t.addDays(k.firstCellDate,7*U)))),X=$(()=>{var v;return{"vuecal--ready":g.ready,[`vuecal--${g.theme}-theme`]:g.theme,[`vuecal--${g.size}`]:!0,"vuecal--date-picker":g.datePicker,"vuecal--dark":g.dark,"vuecal--light":!g.dark,[`vuecal--${k.id}-view`]:!0,"vuecal--view-has-time":w.value,"vuecal--timeless":!g.time,"vuecal--dragging-cell":s.isDraggingCell,"vuecal--dragging-event":s.isDraggingEvent,"vuecal--resizing-event":s.isResizingEvent,"vuecal--has-schedules":(v=g.schedules)==null?void 0:v.length}}),H=$(()=>({"--vuecal-time-cell-height":g.timeCellHeight&&`${g.timeCellHeight}px`})),a=$(()=>{var v,U;return{"vuecal__scrollable--row":w.value||g.weekNumbers&&k.isMonth,[`vuecal__scrollable--${k.id}-view`]:!0,"vuecal__scrollable--has-schedules":(v=g.schedules)==null?void 0:v.length,"vuecal__scrollable--no-schedules":!((U=g.schedules)!=null&&U.length)}});return ke(async()=>{await _e(),o("ready",{config:g,view:k})}),Ce(()=>g.locale,v=>g.loadTexts(v)),Fe("vuecal",Y),b({view:Y.view}),(v,U)=>(u(),m("div",{class:K(["vuecal",X.value]),ref:"vuecal-el","data-locale":v.locale,style:ee(H.value)},[v.$slots.diy?_(v.$slots,"diy",{key:0,vuecal:d(Y),view:d(k),availableViews:d(g).availableViews}):(u(),m(N,{key:1},[oe(Ze,null,re({_:2},[v.$slots.header?{name:"header",fn:z(p=>[_(v.$slots,"header",V(R(p)))]),key:"0"}:void 0,!v.$slots.header&&v.$slots["previous-button"]?{name:"previous-button",fn:z(p=>[_(v.$slots,"previous-button",V(R(p)))]),key:"1"}:void 0,!v.$slots.header&&v.$slots["next-button"]?{name:"next-button",fn:z(p=>[_(v.$slots,"next-button",V(R(p)))]),key:"2"}:void 0,!v.$slots.header&&v.$slots["today-button"]?{name:"today-button",fn:z(p=>[_(v.$slots,"today-button",V(R(p)))]),key:"3"}:void 0,!v.$slots.header&&v.$slots.title?{name:"title",fn:z(p=>[_(v.$slots,"title",V(R(p)))]),key:"4"}:void 0,!v.$slots.header&&v.$slots["schedule-heading"]?{name:"schedule-heading",fn:z(p=>[_(v.$slots,"schedule-heading",V(R(p)))]),key:"5"}:void 0]),1024),W("div",Mt,[oe(he,{name:`vuecal-slide-fade--${d(k).transitionDirection}`},{default:z(()=>[(u(),m("div",{class:K(["vuecal__scrollable",a.value]),key:d(k).id+d(k).start.getTime()},[w.value?(u(),se(it,{key:0},re({_:2},[v.$slots["time-cell"]?{name:"time-cell",fn:z(p=>[_(v.$slots,"time-cell",V(R(p)))]),key:"0"}:void 0]),1024)):P("",!0),d(g).weekNumbers&&d(k).isMonth?(u(),m("div",Yt,[(u(!0),m(N,null,J(B.value,p=>(u(),m("div",Pt,[_(v.$slots,"week-number",{},()=>[W("small",null,F(p),1)])]))),256))])):P("",!0),W("div",zt,[oe(ot,null,re({_:2},[v.$slots["weekday-heading"]?{name:"weekday-heading",fn:z(p=>[_(v.$slots,"weekday-heading",V(R(p)))]),key:"0"}:void 0,v.$slots["schedule-heading"]?{name:"schedule-heading",fn:z(p=>[_(v.$slots,"schedule-heading",V(R(p)))]),key:"1"}:void 0]),1024),oe(Tt,null,re({_:2},[v.$slots.cell?{name:"cell",fn:z(p=>[_(v.$slots,"cell",V(R(p)))]),key:"0"}:void 0,!v.$slots.cell&&v.$slots["cell-date"]?{name:"cell-date",fn:z(p=>[_(v.$slots,"cell-date",V(R(p)))]),key:"1"}:void 0,!v.$slots.cell&&v.$slots["cell-content"]?{name:"cell-content",fn:z(p=>[_(v.$slots,"cell-content",V(R(p)))]),key:"2"}:void 0,!v.$slots.cell&&v.$slots["cell-events"]?{name:"cell-events",fn:z(p=>[_(v.$slots,"cell-events",V(R(p)))]),key:"3"}:void 0,!v.$slots.cell&&v.$slots.event?{name:"event",fn:z(p=>[_(v.$slots,"event",V(R(p)))]),key:"4"}:void 0,!v.$slots.cell&&v.$slots["event-count"]?{name:"event-count",fn:z(p=>[_(v.$slots,"event-count",V(R(p)))]),key:"5"}:void 0]),1024)])],2))]),_:3},8,["name"])])],64))],14,Et))}};export{St as _};
