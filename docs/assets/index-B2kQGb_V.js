import{l as ve,c as $,b as m,d as c,K as p,q as P,g as d,F as I,j as K,i as U,e as W,f as re,w as T,A as te,L as De,y as H,H as ge,M as B,T as ye,t as V,n as G,r as ee,x as fe,o as _e,N as $e,m as Te,D as Oe,I as he,h as Me,z as ie,O as Ee,P as Ne,Q as Ae,R as Ie,S as X,U as Re}from"./index-F1lNJKhl.js";import{w as pe,m as oe,p as de,d as Ve,e as Ce,u as Fe}from"./index-uYrIU1Vg.js";const He=24*60,We={allDayEvents:{type:[Boolean,String],default:!1},stackEvents:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:void 0},dark:{type:Boolean,default:!1},datePicker:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},editableEvents:{type:[Boolean,Object],default:!1},eventCreateMinDrag:{type:Number,default:15},events:{type:Array,default:()=>[]},eventCount:{type:[Boolean,Array],default:!1},eventsOnMonthView:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:String,default:""},maxDate:{type:[String,Date],default:""},minDate:{type:[String,Date],default:""},selectedDate:{type:[String,Date],default:""},sm:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},schedules:{type:Array,default:()=>[]},snapToInterval:{type:Number,default:0},startWeekOnSunday:{type:Boolean,default:!1},theme:{type:[String,Boolean],default:"default"},time:{type:Boolean,default:!0},timeAtCursor:{type:Boolean,default:!1},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:He},titleBar:{type:Boolean,default:!0},todayButton:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},view:{type:String,default:""},viewDate:{type:[String,Date],default:""},viewDayOffset:{type:Number,default:0},views:{type:[Array,Object]},viewsBar:{type:Boolean,default:!0},watchRealTime:{type:Boolean,default:!1},weekNumbers:{type:Boolean,default:!1},xs:{type:Boolean,default:!1}},je={class:"vuecal__header"},Ue={key:0,class:"vuecal__views-bar"},qe=["onClick","innerHTML"],Ge={key:1,class:"vuecal__title-bar"},Ke={class:"vuecal__transition-wrap"},Qe=["disabled","innerHTML"],Je={__name:"header",setup(J){const k=ve("vuecal"),{view:a,config:s}=k,i=()=>{s.clickToNavigate&&a.broader()},_=$(()=>s.clickToNavigate?{click:i}:{});return(C,f)=>(c(),m("div",je,[p(C.$slots,"header",{view:d(a),availableViews:d(s).availableViews,vuecal:d(k)}),C.$slots.header?P("",!0):(c(),m(I,{key:0},[d(s).viewsBar?(c(),m("div",Ue,[(c(!0),m(I,null,K(d(s).availableViews,(D,t)=>(c(),m("button",{class:U(["vuecal__view-button",{"vuecal__view-button--active":d(a).id===t}]),onClick:l=>d(a).switch(t),innerHTML:d(k).texts[t],type:"button"},null,10,qe))),256))])):P("",!0),d(s).titleBar?(c(),m("nav",Ge,[W("button",{class:U(["vuecal__nav vuecal__nav--prev",{"vuecal__nav--default":!C.$slots["previous-button"]}]),onClick:f[0]||(f[0]=(...D)=>d(a).previous&&d(a).previous(...D)),type:"button"},[p(C.$slots,"previous-button")],2),W("div",Ke,[re(ye,{name:`vuecal-slide-fade--${d(a).transitionDirection}`},{default:T(()=>[(c(),m("div",{key:d(a).id+d(a).start.getTime()},[C.$slots.title||C.$slots[`title.${d(a).id}`]?(c(),te(De(d(s).clickToNavigate&&d(a).broaderView?"button":"div"),H({key:0,class:"vuecal__title"},ge(_.value)),{default:T(()=>[C.$slots[`title.${d(a).id}`]?p(C.$slots,`title.${d(a).id}`,B(H({key:0},d(a)))):p(C.$slots,"title",B(H({key:1},d(a))))]),_:3},16)):(c(),te(De(d(s).clickToNavigate&&d(a).broaderView?"button":"div"),H({key:1,class:"vuecal__title"},ge(_.value),{innerHTML:d(a).title}),null,16,["innerHTML"]))]))]),_:3},8,["name"])]),d(s).todayButton?(c(),m(I,{key:0},[C.$slots["today-button"]?p(C.$slots,"today-button",{key:0,navigate:()=>!d(a).containsToday&&d(a).goToToday(),active:d(a).containsToday}):(c(),m("button",{key:1,class:U(["vuecal__nav vuecal__nav--today vuecal__nav--default",{"vuecal__nav--active":d(a).containsToday}]),onClick:f[1]||(f[1]=D=>!d(a).containsToday&&d(a).goToToday()),disabled:!!d(a).containsToday,type:"button",innerHTML:d(k).texts.today},null,10,Qe))],64)):P("",!0),W("button",{class:U(["vuecal__nav vuecal__nav--next",{"vuecal__nav--default":!C.$slots["next-button"]}]),onClick:f[2]||(f[2]=(...D)=>d(a).next&&d(a).next(...D)),type:"button"},[p(C.$slots,"next-button")],2)])):P("",!0)],64))]))}},Ze={key:0,class:"vuecal__headings"},xe={key:0,class:"vuecal__weekdays-headings"},et=["onClick"],tt={class:"vuecal__weekday-day"},st={key:0,class:"vuecal__weekday-date"},lt={key:1,class:"vuecal__schedules-headings w-flex grow"},at=["innerHTML"],nt={__name:"headings-bar",setup(J){const k=ve("vuecal"),{view:a,config:s,dateUtils:i}=k,_=$(()=>s.xs?"day-xs":s.sm||a.isDays||a.isMonth?"day-sm":"day"),C=$(()=>(a.isDay||a.isDays||a.isWeek||a.isMonth)&&!(a.isDay&&!s.schedules)),f=$(()=>a.cellDates.slice(0,a.cols).map(({start:t})=>({id:pe[t.getDay()],date:t,dateNumber:t.getDate(),day:i.formatDate(t,"dddd"),"day-sm":i.formatDate(t,"ddd"),"day-xs":i.formatDate(t,"dd"),isToday:i.isToday(t)}))),D={click:t=>{(a.isDays||a.isWeek)&&a.updateSelectedDate(t)}};return(t,l)=>C.value?(c(),m("div",Ze,[d(a).isDay?P("",!0):(c(),m("div",xe,[(c(!0),m(I,null,K(f.value,(b,O)=>(c(),m("div",{class:U(["vuecal__weekday",{"vuecal__weekday--today":b.isToday}]),key:O,onClick:N=>D.click(b.date)},[p(t.$slots,"weekday-heading",{label:b[_.value],id:b.id,date:b.date},()=>[W("span",tt,V(b[_.value]),1),d(a).isMonth?P("",!0):(c(),m("strong",st,V(b.dateNumber),1))])],10,et))),128))])),d(s).schedules?(c(),m("div",lt,[(c(!0),m(I,null,K(f.value,(b,O)=>(c(),m(I,{key:O},[(c(!0),m(I,null,K(d(s).schedules,(N,F)=>(c(),m(I,{key:F},[t.$slots["schedule-heading"]?(c(),m("div",{key:0,class:U(["vuecal__schedule vuecal__schedule--heading",N.class])},[p(t.$slots,"schedule-heading",{schedule:N,view:d(a)})],2)):(c(),m("div",{key:1,class:U(["vuecal__schedule vuecal__schedule--heading",N.class]),innerHTML:N.label},null,10,at))],64))),128))],64))),128))])):P("",!0)])):P("",!0)}},ot={class:"vuecal__time-column"},rt={__name:"time-column",setup(J){const k=ve("vuecal"),{config:a,texts:s}=k,i=$(()=>{const _=[];for(let f=a.timeFrom;f<a.timeTo;f+=a.timeStep){const D=f+a.timeStep>a.timeTo,t=~~(f/60),l=f%60,b=s[f<720?"am":"pm"];let O=null;D&&(O=`calc(var(--vuecal-time-cell-height) * ${(a.timeTo-f)/a.timeStep})`),_.push({minutesSum:f,hours:t,minutes:l,formatted12:`${t%12?t%12:12}${l?`:${l.toString().padStart(2,0)}`:""}${b}`,formatted24:`${t.toString().padStart(2,0)}:${l.toString().padStart(2,0)}`,height:O})}return _});return(_,C)=>(c(),m("div",ot,[(c(!0),m(I,null,K(i.value,(f,D)=>(c(),m("div",{class:"vuecal__time-cell",key:D,style:G({height:f.height||null})},[p(_.$slots,"time-cell",{index:D,minutes:f.minutes,hours:f.hours,minutesSum:f.minutesSum,format12:f.formatted12,format24:f.formatted24},()=>[W("label",null,V(d(a).twelveHour?f.formatted12:f.formatted24),1)])],4))),128))]))}},it=["draggable"],ut={class:"vuecal__event-details"},ct={class:"vuecal__event-title"},dt={key:0,class:"vuecal__event-time"},vt={key:0,class:"vuecal__event-comma"},mt={class:"vuecal__event-start"},gt={key:1,class:"vuecal__event-end"},ft=["innerHTML"],Ye={__name:"event",props:{event:{type:Object,required:!0}},emits:["event-drag-start","event-drag-end","event-resize-start","event-resize-end"],setup(J,{emit:k}){const{config:a,view:s,dnd:i,touch:_,dateUtils:C}=ve("vuecal"),f=J,D=ee(null),t=fe(f.event),l=fe({dragging:!1,resizing:!1,fromResizer:!1,holding:!1,holdTimer:null,startX:0,startY:0,startPercentageX:0,startPercentageY:0,moveX:0,moveY:0,movePercentageX:0,movePercentageY:0,resizeStartDate:null,resizingOriginalEvent:null,resizingLastAcceptedEvent:null,cellEl:null,schedule:null}),b=$(()=>a.editableEvents.drag&&t.draggable!==!1&&!t.background),O=$(()=>s.isMonth||s.isYear||s.isYears?!1:a.time&&a.editableEvents.resize&&t.resizable!==!1&&!t.background);$(()=>a.editableEvents.delete&&t.deletable!==!1&&!t.background);const N=$(()=>{var g,h,E;return{[`vuecal__event--${t._.id}`]:!0,[t.class]:!!t.class,"vuecal__event--recurring":!!t.recurring,"vuecal__event--background":!!t.background,"vuecal__event--multiday":!!((g=t._)!=null&&g.multiday),"vuecal__event--cut-top":((h=t._)==null?void 0:h.startMinutes)<a.timeFrom,"vuecal__event--cut-bottom":((E=t._)==null?void 0:E.endMinutes)>a.timeTo||t._.multiday,"vuecal__event--dragging":!t._.draggingGhost&&t._.dragging,"vuecal__event--dragging-ghost":t._.draggingGhost,"vuecal__event--resizing":l.resizing}}),F=$(()=>{const g=(s.isDay||s.isDays||s.isWeek)&&a.time;if(!g&&!t.backgroundColor&&!t.color)return!1;const h={backgroundColor:t.backgroundColor||null,color:t.color||null};if(g){const E=Math.max(a.timeFrom,t._.startMinutes),M=Math.min(a.timeTo,t._.endMinutes)+(t._.duration&&!t._.endMinutes?24*60:0),z=oe(E,a),L=oe(M,a)-z;h.top=`${z}%`,h.height=`${L}%`}return h}),n=$(()=>{const g={...a.eventListeners.event};for(const[M,z]of Object.entries(g))["resize-end"].includes(M)||(g[M]=L=>{L.type!=="drop"&&z(L.type?{e:L,event:t}:L)});const h={...g};g.touchstart=M=>{var z;M.stopPropagation(),o(M),(z=h.touchstart)==null||z.call(h,{e:M,event:t})},g.mousedown=M=>{var z;M.stopPropagation(),o(M),(z=h.mousedown)==null||z.call(h,{e:M,event:t})};let E=null;return g.click=M=>{var z;(z=h.click)==null||z.call(h,{e:M,event:t}),E?E=clearTimeout(E):E=setTimeout(()=>{var L;E=null,(L=h["delayed-click"])==null||L.call(h,{e:M,event:t})},400)},g.dblclick=M=>{h.dblclick?h.dblclick({e:M,event:t}):t.delete(1)},g}),o=g=>{var M,z,L;const h=((M=g.touches)==null?void 0:M[0])||g;l.fromResizer=h.target.matches(".vuecal__event-resizer, .vuecal__event-resizer *");const E=D.value.getBoundingClientRect();l.startX=(((z=g.touches)==null?void 0:z[0])||g).clientX-E.left,l.startY=(((L=g.touches)==null?void 0:L[0])||g).clientY-E.top,l.startPercentageX=l.startX*100/E.width,l.startPercentageY=l.startY*100/E.height,l.cellEl=D.value.closest(".vuecal__cell"),l.resizeStartDate=t.start,se(g.type==="touchstart"?"touchmove":"mousemove",j),se(g.type==="touchstart"?"touchend":"mouseup",y,{once:!0}),l.holdTimer=setTimeout(()=>{var A,q;l.holding=!0,(q=(A=n.value).hold)==null||q.call(A,{e:g,event:t})},1e3)},j=async g=>{var E,M,z,L;const h=((E=g.touches)==null?void 0:E[0])||g;if(l.fromResizer&&!l.resizing&&(l.resizing=!0,l.resizingOriginalEvent={...t,_:{...t._}},_.isResizingEvent=!0,(z=(M=n.value).resizeStart)==null||z.call(M,{e:g,event:t})),l.holdTimer=clearTimeout(l.holdTimer),l.holding=!1,l.cellEl){const{top:A,left:q,width:le,height:Q}=l.cellEl.getBoundingClientRect();l.moveX=h.clientX-q,l.moveY=h.clientY-A,l.movePercentageX=l.moveX*100/le,l.movePercentageY=l.moveY*100/Q}if(l.fromResizer){const{newStart:A,newEnd:q}=ue(t);let le=!0;const{resize:Q}=(L=a.eventListeners)==null?void 0:L.event;Q&&(le=await Q({e:g,event:{...t,start:A,end:q},overlaps:t.getOverlappingEvents({start:A,end:q})})),le!==!1?(t.start=A,t.end=q,l.resizingLastAcceptedEvent&&(l.resizingLastAcceptedEvent=null)):Q&&(l.resizingLastAcceptedEvent={...t,_:{...t._}})}},y=async g=>{var h,E;if(l.holdTimer=clearTimeout(l.holdTimer),l.holding=!1,l.resizing){const{newStart:M,newEnd:z}=ue(t);let L=!0;const A=n.value["resize-end"];A&&(L=await A({e:g,event:t,original:l.resizingOriginalEvent,overlaps:t.getOverlappingEvents({start:M,end:z})})),t.start=L===!1?(l.resizingLastAcceptedEvent||l.resizingOriginalEvent).start:((h=l.resizingLastAcceptedEvent)==null?void 0:h.start)||M,t.end=L===!1?(l.resizingLastAcceptedEvent||l.resizingOriginalEvent).end:((E=l.resizingLastAcceptedEvent)==null?void 0:E.end)||z,t._.duration<1&&(t.start=l.resizingOriginalEvent.start,t.end=l.resizingOriginalEvent.end),_.isResizingEvent=!1}document.removeEventListener(g.type==="touchend"?"touchmove":"mousemove",j),l.resizing=!1,l.fromResizer=!1,l.dragging=!1,l.startX=0,l.startY=0,l.moveX=0,l.moveY=0,l.startPercentageX=0,l.startPercentageY=0,l.movePercentageX=0,l.movePercentageY=0,l.cellEl=null,l.resizeStartDate=null,l.resizingOriginalEvent=null,l.resizingLastAcceptedEvent=null,l.schedule=null},ue=g=>{const h=new Date(g.start.getFullYear(),g.start.getMonth(),g.start.getDate());new Date(h).setDate(h.getDate()+1);let M=de(l.movePercentageY,a);if(M=Math.max(0,Math.min(M,24*60)),a.snapToInterval){const A=M+a.snapToInterval/2;M=A-A%a.snapToInterval}let z=g.start,L=new Date(h.getTime()+M*6e4);return L<l.resizeStartDate&&(z=L,L=l.resizeStartDate),{newStart:z,newEnd:L}};_e(()=>t._.register(D.value));const me=[],se=(g,h,E)=>{document.addEventListener(g,h,E),me.push({event:g,handler:h,options:E})};return $e(()=>{t._.unregister();for(const{event:g,handler:h,options:E}of me)document.removeEventListener(g,h,E)}),(g,h)=>(c(),m("div",H({class:"vuecal__event"},ge(n.value,!0),{ref_key:"eventEl",ref:D,class:N.value,style:F.value,draggable:b.value?"true":void 0,onDragstart:h[2]||(h[2]=E=>b.value&&d(i).eventDragStart(E,t)),onDragend:h[3]||(h[3]=E=>b.value&&d(i).eventDragEnd(E,t))}),[W("div",ut,[p(g.$slots,"event",{event:t},()=>[W("div",ct,V(t.title),1),d(a).time&&!(d(a).allDayEvents&&t.allDay)?(c(),m("div",dt,[d(s).isMonth?(c(),m("span",vt,",")):P("",!0),W("span",mt,V(t._[`startTimeFormatted${d(a).twelveHour?12:24}`]),1),d(s).isMonth?P("",!0):(c(),m("span",gt,"- "+V(t._[`endTimeFormatted${d(a).twelveHour?12:24}`]),1))])):P("",!0),W("div",{class:"vuecal__event-content",innerHTML:t.content},null,8,ft)])]),O.value?(c(),m("div",{key:0,class:"vuecal__event-resizer",onDragstart:h[0]||(h[0]=Te(()=>{},["prevent","stop"]))},null,32)):P("",!0),re(ye,{name:"vuecal-delete-btn"},{default:T(()=>[t._.deleting?(c(),m("div",{key:0,class:"vuecal__event-delete",onClick:h[1]||(h[1]=Te(E=>t.delete(3),["stop"]))},"Delete")):P("",!0)]),_:1})],16,it))}},yt=["innerHTML"],ht=["data-schedule"],pt={key:1,class:"vuecal__cell-date"},_t={key:2,class:"vuecal__cell-content"},$t={key:3,class:"vuecal__cell-events"},kt={key:1,class:"vuecal__cell-date"},wt={key:2,class:"vuecal__cell-content"},bt={key:3,class:"vuecal__cell-events"},Dt={key:5,class:"vuecal__cell-events-count"},Tt=["title"],Mt={__name:"cell",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},index:{type:Number,required:!0}},setup(J){const k=J,a=ve("vuecal"),{view:s,config:i,dateUtils:_,eventsManager:C,dnd:f,touch:D}=a,t=$(()=>_.isToday(k.start)),l=ee(null),b=ee([]),O=ee(!1),N=e=>{b.value.push(e.detail),O.value=!0},F=()=>setTimeout(()=>O.value=!1,300),n=fe({dragging:!1,holding:!1,holdTimer:null,thresholdPassed:!1,startX:0,startY:0,moveX:0,moveY:0,startPercentageX:0,startPercentageY:0,movePercentageX:0,movePercentageY:0,schedule:null}),o=ee(!1),j=ee({cellOverlaps:{},longestStreak:0}),y=$(()=>{let e=Math.min(n.startPercentageY,n.movePercentageY),r=Math.max(n.startPercentageY,n.movePercentageY),v=de(e,i),u=de(r,i);return i.snapToInterval&&(v=_.snapToInterval(v,i.snapToInterval),u=_.snapToInterval(u,i.snapToInterval),e=oe(v,i),r=oe(u,i)),{style:{top:`${e}%`,height:`${Math.abs(r-e)}%`},startMinutes:v,endMinutes:u,start:_.formatMinutes(v),end:_.formatMinutes(u),...n.schedule?{schedule:n.schedule}:{}}}),ue=$(()=>{const e=i.editableEvents.create&&(n.dragging||o.value),r=i.eventCreateMinDrag&&n.thresholdPassed||!i.eventCreateMinDrag;return e&&r}),me=$(()=>{var R;const e=new Date,r=s.start.getFullYear(),v=s.start.getMonth(),u=k.start.getFullYear(),w=k.start.getMonth();return{[`vuecal__cell--${pe[k.start.getDay()]}`]:s.isDay||s.isDays||s.isWeek||s.isMonth,[`vuecal__cell--${Ve[w]}`]:s.isYear,[`vuecal__cell--${u}`]:s.isYears,"vuecal__cell--today":t.value,"vuecal__cell--current-month":s.isYear&&u===e.getFullYear()&&w===e.getMonth(),"vuecal__cell--current-year":s.isYears&&u===e.getFullYear(),"vuecal__cell--out-of-range":s.isMonth&&(u!==r||w!==v),"vuecal__cell--before-min":Q.value&&q.value,"vuecal__cell--after-max":Q.value&&le.value,"vuecal__cell--disabled":Q.value,"vuecal__cell--selected":s.selectedDate&&s.selectedDate.getTime()>=k.start.getTime()&&s.selectedDate.getTime()<=k.end.getTime(),"vuecal__cell--has-schedules":(R=i.schedules)==null?void 0:R.length,"vuecal__cell--dragging":n.dragging,"vuecal__cell--has-events":g.value.length}});$(()=>_.formatDate(k.start));const se=$(()=>{switch(s.id){case"day":return"";case"days":return i.availableViews.days.rows>1&&_.formatDate(k.start,"D"),"";case"week":return"";case"month":return _.formatDate(k.start,"D");case"year":return _.formatDate(k.start,i.xs?"MMM":"MMMM");case"years":return _.formatDate(k.start,"YYYY")}}),g=$(()=>i.datePicker?[]:C.getEventsInRange(k.start,k.end,{excludeIds:b.value})),h=$(()=>g.value.filter(e=>!e.background)),E=$(()=>{var e;return(e=i.schedules)==null?void 0:e.reduce((r,v)=>(r[v.id]=g.value.filter(u=>u.schedule===v.id),r),{})}),M=$(()=>{if(s.isMonth||s.isYear||s.isYears)return{};const e={};for(const r of g.value){const v=r._.id,{maxConcurrent:u=1,position:w=0}=j.value.cellOverlaps[v]||{};e[v]={left:`${100/u*w}%`},i.stackEvents?e[v].width=`${100/u+(w===u-1?0:15)}%`:e[v].width=`${100/u}%`}return e}),z=$(()=>{const e={};for(const r of g.value){const v=r._.id,{maxConcurrent:u=1,position:w=0}=j.value.cellOverlaps[v]||{};e[v]=`vuecal__event--stack-${w+1}-${u}`}return e}),L=$(()=>i.showCellEventCount&&h.value.length),A=$(()=>{var v;if(!i.specialHours||s.isMonth||s.isYear||s.isYears)return;const e=pe[k.start.getDay()];let r=(v=i.specialHours)==null?void 0:v[e];if(r)return Array.isArray(r)||(r=[r]),r.map(u=>{let{from:w,to:Y,class:R,label:Z}=u;if(isNaN(w)||isNaN(Y)||i.timeFrom>=Y||i.timeTo<=w)return;w=Math.max(i.timeFrom,w),Y=Math.min(i.timeTo,Y);const ne=oe(w,i),Xe=oe(Y,i)-ne;return{style:{top:`${ne}%`,height:`${Xe}%`},label:Z,class:R}}).filter(u=>!!u)}),q=$(()=>i.minTimestamp!==null&&i.minTimestamp>k.end.getTime()),le=$(()=>i.maxTimestamp&&i.maxTimestamp<k.start.getTime()),Q=$(()=>{const{disableDays:e}=i,r=s.isYear||s.isYears;return e.length&&e.includes(_.formatDate(k.start))&&!r?!0:q.value||le.value}),ce=fe({show:$(()=>{if(!(!s.isDay&&!s.isDays&&!s.isWeek)&&!(!t.value||!i.time)&&!(i.timeFrom>_.dateToMinutes(s.now))&&!(_.dateToMinutes(s.now)>i.timeTo))return!0}),nowInMinutes:$(()=>_.dateToMinutes(s.now)),todaysTimePosition:$(()=>oe(ce.nowInMinutes,i)),style:$(()=>`top: ${ce.todaysTimePosition}%`),currentTime:$(()=>_.formatTime(s.now))}),ae=$(()=>{if(Q.value)return{};const e={...i.eventListeners.cell};for(const[u,w]of Object.entries(e))e[u]=Y=>{var R,Z,ne;(ne=(Z=Y.target||((R=Y.e)==null?void 0:R.target)).closest)!=null&&ne.call(Z,".vuecal__event")||w(Y.type?{e:Y,cell:S.value,cursor:x.value}:Y)};const r={...e};let v=null;return e.click=u=>{var Y;Pe();const w=ke(u);(Y=r.click)==null||Y.call(r,{e:u,cell:S.value,cursor:w}),v?v=clearTimeout(v):v=setTimeout(()=>{var R;v=null,(R=r["delayed-click"])==null||R.call(r,{e:u,cell:S.value,cursor:w})},400)},(i.time&&s.isDay||s.isDays||s.isWeek)&&(e.touchstart=u=>{var w;we(u.e||u),(w=r.touchstart)==null||w.call(r,{e:u,cell:S.value,cursor:x.value})},e.mousedown=u=>{var w;we(u.e||u),(w=r.mousedown)==null||w.call(r,{e:u,cell:S.value,cursor:x.value})}),r.dblclick&&(e.dblclick=u=>{var w;(w=r.dblclick)==null||w.call(r,{e:u,cell:S.value,cursor:ke(u)})}),i.editableEvents.drag&&(e.dragenter=u=>f.cellDragEnter(u,S.value),e.dragover=u=>{u.preventDefault(),f.cellDragOver(u,S.value)},e.dragleave=u=>f.cellDragLeave(u,S.value),e.drop=u=>f.cellDragDrop(u,S.value)),e}),S=$(()=>({start:k.start,end:k.end,events:g,...n.schedule?{schedule:n.schedule}:{},goNarrower:()=>s.narrower(),goBroader:()=>s.broader(),broader:s.broaderView,narrower:s.narrowerView})),ke=e=>{var Y;const r=(((Y=e.touches)==null?void 0:Y[0])||e).clientY,{top:v}=l.value.getBoundingClientRect(),u=Ce(r-v,l.value),w=new Date(k.start);return w.setMinutes(de(u,i)),{y:u,date:w}},x=$(()=>{const e=de(n.movePercentageY||n.startPercentageY,i),r=new Date(k.start);return r.setMinutes(e),{x:n.movePercentageX||n.startPercentageX,y:n.movePercentageY||n.startPercentageY,date:r}}),Pe=()=>{s.updateSelectedDate(k.start),i.clickToNavigate&&((s.isMonth||s.isDays||s.isWeek)&&i.availableViews.day?s.switch("day"):s.isYear&&i.availableViews.month?s.switch("month"):s.isYears&&i.availableViews.year&&s.switch("year")),s.updateViewDate(k.start)},we=e=>{var v,u;n.schedule=~~e.target.dataset.schedule;const r=l.value.getBoundingClientRect();n.startX=(((v=e.touches)==null?void 0:v[0])||e).clientX-r.left,n.startY=(((u=e.touches)==null?void 0:u[0])||e).clientY-r.top,n.startPercentageX=n.startX*100/r.width,n.startPercentageY=n.startY*100/r.height,n.thresholdPassed=!1,document.addEventListener(e.type==="touchstart"?"touchmove":"mousemove",be),document.addEventListener(e.type==="touchstart"?"touchend":"mouseup",ze,{once:!0}),n.holdTimer=setTimeout(()=>{var w,Y;n.holding=!0,(Y=(w=ae.value).hold)==null||Y.call(w,{e,cell:S.value,cursor:x.value})},1e3)},be=e=>{var v,u,w,Y,R,Z;n.dragging||(D.isDraggingCell=!0,(u=(v=ae.value)["drag-start"])==null||u.call(v,{e,cell:S.value,cursor:x.value})),n.dragging=!0,n.holdTimer=clearTimeout(n.holdTimer),n.holding=!1;const r=l.value.getBoundingClientRect();n.moveX=(((w=e.touches)==null?void 0:w[0])||e).clientX-r.left,n.moveY=(((Y=e.touches)==null?void 0:Y[0])||e).clientY-r.top,n.movePercentageX=n.moveX*100/r.width,n.movePercentageY=n.moveY*100/r.height,i.eventCreateMinDrag&&Math.abs(n.startY-n.moveY)>i.eventCreateMinDrag&&(n.thresholdPassed=!0),(Z=(R=ae.value).drag)==null||Z.call(R,{e,cell:S.value,cursor:x.value})},ze=async e=>{var r,v;document.removeEventListener(e.type==="touchend"?"touchmove":"mousemove",be,{passive:!1}),n.dragging&&((v=(r=ae.value)["drag-end"])==null||v.call(r,{e,cell:S.value,cursor:x.value}),D.isDraggingCell=!1,i.editableEvents.create&&(o.value=!0,await Le(e),o.value=!1)),n.holdTimer=clearTimeout(n.holdTimer),n.holding=!1,n.dragging=!1,n.startX=0,n.startY=0,n.moveX=0,n.moveY=0,n.startPercentageX=0,n.startPercentageY=0,n.movePercentageX=0,n.movePercentageY=0,n.thresholdPassed=!1,n.schedule=null},Le=async e=>{if(!ue.value)return;let{start:r,end:v,startMinutes:u,endMinutes:w}=y.value;r=new Date(k.start),r.setMinutes(u),v=new Date(k.start),v.setMinutes(w);let Y={...y.value,start:r,end:v};const{create:R}=i.eventListeners.event;if(typeof R=="function"){const Z=Y;Y=await new Promise(ne=>R({e,event:Y,cell:S.value,resolve:ne,cursor:x.value})),Y&&typeof Y=="object"&&s.createEvent(Y),Y&&typeof Y=="boolean"&&s.createEvent(Z)}else s.createEvent(Y)},Se=()=>{var e;for(const r of Object.keys(ae.value))(e=l.value)==null||e.removeEventListener(r,ae.value[r])},Be=()=>{j.value=C.getCellOverlappingEvents(k.start,k.end)};return Oe(()=>!s.isYears&&!s.isYear&&h.value.map(e=>`${e._.id}${e.start.getTime()}${e.end.getTime()}`).join(),async()=>{await he(),Be()},{immediate:!0,flush:"post"}),$e(async()=>{for(const e of b.value)C.deleteEvent(e,3);Se(),await he()}),(e,r)=>(c(),m("div",H({class:["vuecal__cell",me.value],ref_key:"cellEl",ref:l},ge(ae.value,!0)),[e.$slots.cell?p(e.$slots,"cell",{key:0,cell:S.value}):P("",!0),A.value?(c(!0),m(I,{key:1},K(A.value,(v,u)=>(c(),m("div",{class:U(["vuecal__special-hours",v.class]),style:G(v.style),innerHTML:v.label||""},null,14,yt))),256)):P("",!0),!e.$slots.cell&&d(i).schedules?(c(!0),m(I,{key:2},K(d(i).schedules,v=>(c(),m("div",{class:U(["vuecal__schedule vuecal__schedule--cell",v.class]),key:v.id,style:G(v.style||null),"data-schedule":v.id},[e.$slots["cell-events"]?p(e.$slots,"cell-events",{key:0,cell:S.value}):P("",!0),se.value||e.$slots["cell-date"]?(c(),m("div",pt,[p(e.$slots,"cell-date",{cell:S.value},()=>[Me(V(se.value),1)])])):P("",!0),e.$slots["cell-content"]?(c(),m("div",_t,[p(e.$slots,"cell-content",{cell:S.value})])):P("",!0),e.$slots["cell-events"]&&g.value.length?(c(),m("div",$t,[p(e.$slots,"cell-events",{cell:S.value})])):g.value.length||O.value?(c(),te(Ee,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:r[0]||(r[0]=u=>O.value=!0),onAfterLeave:F,tag:"div"},{default:T(()=>[(c(!0),m(I,null,K(E.value[v.id],u=>(c(),te(Ye,{key:u._.id,event:u,onEventDeleted:N,style:G(M.value[u._.id])},ie({_:2},[e.$slots.event?{name:"event",fn:T(w=>[p(e.$slots,"event",H({ref_for:!0},w))]),key:"0"}:void 0]),1032,["event","style"]))),128))]),_:2},1024)):P("",!0),ue.value&&n.schedule===v.id?(c(),m("div",{key:5,class:"vuecal__event-placeholder",style:G(y.value.style)},V(y.value.start)+" - "+V(y.value.end),5)):P("",!0)],14,ht))),128)):P("",!0),!e.$slots.cell&&!d(i).schedules?(c(),m(I,{key:3},[e.$slots["cell-events"]?p(e.$slots,"cell-events",{key:0,cell:S.value}):P("",!0),se.value||e.$slots["cell-date"]?(c(),m("div",kt,[p(e.$slots,"cell-date",{cell:S.value},()=>[Me(V(se.value),1)])])):P("",!0),e.$slots["cell-content"]?(c(),m("div",wt,[p(e.$slots,"cell-content",{cell:S.value})])):P("",!0),e.$slots["cell-events"]&&g.value.length?(c(),m("div",bt,[p(e.$slots,"cell-events",{cell:S.value})])):!(d(s).isMonth&&!d(i).eventsOnMonthView)&&!d(s).isYear&&!d(s).isYears&&(g.value.length||O.value)?(c(),te(Ee,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:r[1]||(r[1]=v=>O.value=!0),onAfterLeave:F,tag:"div"},{default:T(()=>[(c(!0),m(I,null,K(g.value,v=>(c(),te(Ye,{key:v._.id,event:v,onEventDeleted:N,class:U(z.value[v._.id]),style:G(M.value[v._.id])},ie({_:2},[e.$slots.event?{name:"event",fn:T(u=>[p(e.$slots,"event",H({ref_for:!0},u))]),key:"0"}:void 0]),1032,["event","class","style"]))),128))]),_:3})):P("",!0),ue.value?(c(),m("div",{key:5,class:"vuecal__event-placeholder",style:G(y.value.style)},V(y.value.start)+" - "+V(y.value.end),5)):P("",!0)],64)):P("",!0),e.$slots["event-count"]?p(e.$slots,"event-count",{key:4,events:h.value}):L.value?(c(),m("div",Dt,V(h.value.length),1)):P("",!0),ce.show?(c(),m("div",{key:6,class:"vuecal__now-line",style:G(ce.style),title:ce.currentTime},[W("span",null,V(ce.currentTime),1)],12,Tt)):P("",!0)],16))}},Et={__name:"body",setup(J){const k=ve("vuecal"),{view:a,config:s,dateUtils:i}=k,_=ee(null),C=ee(null),f=$(()=>({"--vuecal-grid-columns":a.cols,"--vuecal-grid-rows":a.rows})),D=$(()=>{const b=i.formatTime(de(C.value,s));return{style:{top:`${C.value}%`},time:b}}),t=b=>{var F;if(a.isMonth||a.isYear||a.isYears)return;const O=(((F=b.touches)==null?void 0:F[0])||b).clientY,{top:N}=_.value.getBoundingClientRect();C.value=Ce(O-N,_.value)},l=()=>{C.value=null};return _e(()=>{_.value.addEventListener("mousemove",t),_.value.addEventListener("touchmove",t),_.value.addEventListener("mouseleave",l),_.value.addEventListener("touchend",l)}),$e(()=>{_.value&&(_.value.removeEventListener("mousemove",t),_.value.removeEventListener("touchmove",t),_.value.removeEventListener("mouseleave",l),_.value.removeEventListener("touchend",l))}),(b,O)=>(c(),m("div",{class:"vuecal__body",ref_key:"bodyEl",ref:_,style:G(f.value)},[re(ye,{name:"vuecal-shrink"},{default:T(()=>[d(s).timeAtCursor&&C.value!==null?(c(),m("div",{key:0,class:"vuecal__time-at-cursor",style:G(D.value.style)},[W("label",null,V(D.value.time),1)],4)):P("",!0)]),_:1}),(c(!0),m(I,null,K(d(a).cellDates,(N,F)=>(c(),te(Mt,{key:F,start:N.start,end:N.end,index:F},ie({_:2},[b.$slots.cell?{name:"cell",fn:T(n=>[p(b.$slots,"cell",H({ref_for:!0},n))]),key:"0"}:void 0,b.$slots["cell-date"]?{name:"cell-date",fn:T(n=>[p(b.$slots,"cell-date",H({ref_for:!0},n))]),key:"1"}:void 0,b.$slots["cell-content"]?{name:"cell-content",fn:T(n=>[p(b.$slots,"cell-content",H({ref_for:!0},n))]),key:"2"}:void 0,b.$slots["cell-events"]?{name:"cell-events",fn:T(n=>[p(b.$slots,"cell-events",H({ref_for:!0},n))]),key:"3"}:b.$slots.event?{name:"event",fn:T(n=>[p(b.$slots,"event",H({ref_for:!0},n))]),key:"4"}:b.$slots["event-count"]?{name:"event-count",fn:T(n=>[p(b.$slots,"event-count",H({ref_for:!0},n))]),key:"5"}:void 0]),1032,["start","end","index"]))),128))],4))}},Yt=["data-locale"],Ct={class:"vuecal__scrollable-wrap"},Pt={key:1,class:"vuecal__week-numbers"},zt={class:"vuecal__week-number"},Lt={class:"vuecal__body-wrap"},Xt={__name:"index",props:We,emits:["ready","view-change","update:view","update:selectedDate","update:viewDate","update:events","event-delete","event-created","event-dropped","event-drag-start","event-drag-end"],setup(J,{expose:k,emit:a}){const s=J,i=a,_=Ne("vuecal-el"),C=Fe({props:s,emit:i,attrs:Ie(),vuecalEl:_,uid:Ae()}),{config:f,view:D,dateUtils:t,touch:l}=C,b=$(()=>f.time&&(D.isDay||D.isDays||D.isWeek)),O=$(()=>Array(D.rows).fill().map((o,j)=>t.getWeek(t.addDays(D.firstCellDate,7*j)))),N=$(()=>{var o;return{"vuecal--ready":f.ready,[`vuecal--${f.theme}-theme`]:f.theme,[`vuecal--${f.size}`]:!0,"vuecal--date-picker":f.datePicker,"vuecal--dark":f.dark,"vuecal--light":!f.dark,[`vuecal--${D.id}-view`]:!0,"vuecal--view-has-time":b.value,"vuecal--timeless":!f.time,"vuecal--dragging-cell":l.isDraggingCell,"vuecal--dragging-event":l.isDraggingEvent,"vuecal--resizing-event":l.isResizingEvent,"vuecal--has-schedules":(o=f.schedules)==null?void 0:o.length}}),F=$(()=>({"--vuecal-time-cell-height":f.timeCellHeight&&`${f.timeCellHeight}px`})),n=$(()=>{var o,j;return{"vuecal__scrollable--row":b.value||f.weekNumbers&&D.isMonth,[`vuecal__scrollable--${D.id}-view`]:!0,"vuecal__scrollable--has-schedules":(o=f.schedules)==null?void 0:o.length,"vuecal__scrollable--no-schedules":!((j=f.schedules)!=null&&j.length)}});return _e(async()=>{await he(),f.ready=!0,i("ready",{config:f,view:D})}),Re("vuecal",C),k({view:C.view}),(o,j)=>(c(),m("div",{class:U(["vuecal",N.value]),ref:"vuecal-el","data-locale":o.locale,style:G(F.value)},[o.$slots.diy?p(o.$slots,"diy",{key:0,vuecal:d(C)}):(c(),m(I,{key:1},[re(Je,null,ie({_:2},[o.$slots.header?{name:"header",fn:T(y=>[p(o.$slots,"header",B(X(y)))]),key:"0"}:void 0,!o.$slots.header&&o.$slots["previous-button"]?{name:"previous-button",fn:T(y=>[p(o.$slots,"previous-button",B(X(y)))]),key:"1"}:void 0,!o.$slots.header&&o.$slots["next-button"]?{name:"next-button",fn:T(y=>[p(o.$slots,"next-button",B(X(y)))]),key:"2"}:void 0,!o.$slots.header&&o.$slots["today-button"]?{name:"today-button",fn:T(y=>[p(o.$slots,"today-button",B(X(y)))]),key:"3"}:void 0,!o.$slots.header&&o.$slots.title?{name:"title",fn:T(y=>[p(o.$slots,"title",B(X(y)))]),key:"4"}:void 0,!o.$slots.header&&o.$slots["title.day"]?{name:"title.day",fn:T(y=>[p(o.$slots,"title.day",B(X(y)))]),key:"5"}:void 0,!o.$slots.header&&o.$slots["title.days"]?{name:"title.days",fn:T(y=>[p(o.$slots,"title.days",B(X(y)))]),key:"6"}:void 0,!o.$slots.header&&o.$slots["title.week"]?{name:"title.week",fn:T(y=>[p(o.$slots,"title.week",B(X(y)))]),key:"7"}:void 0,!o.$slots.header&&o.$slots["title.month"]?{name:"title.month",fn:T(y=>[p(o.$slots,"title.month",B(X(y)))]),key:"8"}:void 0,!o.$slots.header&&o.$slots["title.year"]?{name:"title.year",fn:T(y=>[p(o.$slots,"title.year",B(X(y)))]),key:"9"}:void 0,!o.$slots.header&&o.$slots["title.years"]?{name:"title.years",fn:T(y=>[p(o.$slots,"title.years",B(X(y)))]),key:"10"}:void 0,!o.$slots.header&&o.$slots["schedule-heading"]?{name:"schedule-heading",fn:T(y=>[p(o.$slots,"schedule-heading",B(X(y)))]),key:"11"}:void 0]),1024),W("div",Ct,[re(ye,{name:`vuecal-slide-fade--${d(D).transitionDirection}`},{default:T(()=>[(c(),m("div",{class:U(["vuecal__scrollable",n.value]),key:d(D).id+d(D).start.getTime()},[b.value?(c(),te(rt,{key:0},ie({_:2},[o.$slots["time-cell"]?{name:"time-cell",fn:T(y=>[p(o.$slots,"time-cell",B(X(y)))]),key:"0"}:void 0]),1024)):P("",!0),d(f).weekNumbers&&d(D).isMonth?(c(),m("div",Pt,[(c(!0),m(I,null,K(O.value,y=>(c(),m("div",zt,[p(o.$slots,"week-number",{},()=>[W("small",null,V(y),1)])]))),256))])):P("",!0),W("div",Lt,[re(nt,null,ie({_:2},[o.$slots["weekday-heading"]?{name:"weekday-heading",fn:T(y=>[p(o.$slots,"weekday-heading",B(X(y)))]),key:"0"}:void 0,o.$slots["schedule-heading"]?{name:"schedule-heading",fn:T(y=>[p(o.$slots,"schedule-heading",B(X(y)))]),key:"1"}:void 0]),1024),re(Et,null,ie({_:2},[o.$slots.cell?{name:"cell",fn:T(y=>[p(o.$slots,"cell",B(X(y)))]),key:"0"}:void 0,!o.$slots.cell&&o.$slots["cell-date"]?{name:"cell-date",fn:T(y=>[p(o.$slots,"cell-date",B(X(y)))]),key:"1"}:void 0,!o.$slots.cell&&o.$slots["cell-content"]?{name:"cell-content",fn:T(y=>[p(o.$slots,"cell-content",B(X(y)))]),key:"2"}:void 0,!o.$slots.cell&&o.$slots["cell-events"]?{name:"cell-events",fn:T(y=>[p(o.$slots,"cell-events",B(X(y)))]),key:"3"}:void 0,!o.$slots.cell&&o.$slots.event?{name:"event",fn:T(y=>[p(o.$slots,"event",B(X(y)))]),key:"4"}:void 0,!o.$slots.cell&&o.$slots["event-count"]?{name:"event-count",fn:T(y=>[p(o.$slots,"event-count",B(X(y)))]),key:"5"}:void 0]),1024)])],2))]),_:3},8,["name"])])],64))],14,Yt))}};export{Xt as _};
