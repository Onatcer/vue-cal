import{c as V,v as ne,D as G,V as pe,W as v,r as X,O as Te}from"./index-zTcikSW_.js";const N={texts:{weekDays:Array(7).fill(""),weekDaysShort:[],months:Array(12).fill(""),years:"",year:"",month:"",week:"",day:"",today:"",noEvent:"",allDay:"",deleteEvent:"",createEvent:"",dateFormat:"dddd MMMM D, YYYY",am:"am",pm:"pm",truncations:!0},availableViews:{day:{cols:1,rows:1},days:{cols:10,rows:1},week:{cols:7,rows:1},month:{cols:7,rows:6},year:{cols:4,rows:3},years:{cols:5,rows:5}}},je=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],Me=["sun","mon","tue","wed","thu","fri","sat"],Ee=Me.reduce((o,n,h)=>(o[n]=h||7,o),{}),Ve=(o,n,h)=>{const{dateUtils:O}=o,Y=!1,E=V(()=>{if(S.value[n.view])return n.view;{const d=n.datePicker?"month":"week",D=n.view||d;return S.value[D]?D:(console.warn(`Vue Cal: the provided or default view \`${D}\` is either invalid or not in the list of available views. The first available view will be chosen: \`${Object.keys(S.value)[0]}\`.`),Object.keys(S.value)[0])}}),F=V(()=>n.sm&&!n.xs),g=V(()=>n.xs||n.datePicker),W=V(()=>n.clickToNavigate||n.datePicker&&n.clickToNavigate!==!1),P=V(()=>{const d={cell:{},event:{}},D=m=>m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return Object.entries(h).forEach(([m,a])=>{const[y,k,L]=m.match(/^on(Cell|Event)(.+)$/)||[];y&&(d[k.toLowerCase()][D(L).replace(/^-+|-+$/g,"")]=a)}),d}),I=V(()=>{var D;const d={};return n.hideWeekends&&(d[6]=!0)&&(d[7]=!0),(D=n.hideWeekdays)!=null&&D.length&&n.hideWeekdays.forEach(m=>d[Ee[m]]=!0),d}),T=V(()=>n.hideWeekends||I.value[6]&&I.value[7]),S=V(()=>{const d=n.datePicker;let D=0,m={};const a=n.views;return d&&!a?{month:{...N.availableViews.month},year:{...N.availableViews.year},years:{...N.availableViews.years}}:(a?(Array.isArray(a)?m=a.reduce((y,k)=>(typeof k=="string"&&N.availableViews[k]?y[k]=N.availableViews[k]:D++,y),{}):typeof a=="object"&&(m=Object.entries(a).reduce((y,[k,L])=>{const{cols:x,rows:Q}=N.availableViews[k];return y[k]={cols:L.cols||x,rows:L.rows||Q},y},{})),D&&console.warn("Vue Cal: the provided `views` prop contains invalid views that will be ignored."),Object.keys(m).length||(console.warn("Vue Cal: No valid view in the provided `views` prop. Falling back to default views."),m={...N.availableViews})):m={...N.availableViews},m)}),H=V(()=>(console.log("recomputing defaultView"),n.datePicker?"month":S.value.week?"week":Object.keys(S.value)[0])),i=V(()=>{if(typeof n.selectedDate=="string")return O.stringToDate(n.selectedDate);if(n.selectedDate instanceof Date)return n.selectedDate;n.selectedDate?console.warn("Vue Cal: The provided selected date is invalid:",n.selectedDate):console.log("Vue Cal: Info - The provided selected date is undefined.")}),M=V(()=>{let d=null;return n.minDate&&typeof n.minDate=="string"?d=O.stringToDate(n.minDate):n.minDate&&n.minDate instanceof Date&&(d=n.minDate),(d==null?void 0:d.getTime())||null}),t=V(()=>{let d=null;return n.maxDate&&typeof n.maxDate=="string"?d=O.stringToDate(n.maxDate):n.maxDate&&n.maxDate instanceof Date&&(d=n.maxDate),(d==null?void 0:d.getTime())||null}),r=V(()=>{var m;const{view:d}=o;return n.schedules.length&&(d.isDay||d.isDays||d.isWeek)&&((m=n.schedules)==null?void 0:m.map((a,y)=>({...a,id:a.id??y+1})))||void 0}),f=V(()=>{const d={drag:!0,resize:!0,delete:!0,create:!0};return n.editableEvents===!0?d:n.editableEvents===!1?Object.keys(d).map(D=>d[D]=!1):{...d,...n.editableEvents}}),c=async d=>{var m;let D=Object.assign({"../i18n/ar.json":()=>v(()=>import("./ar-BYzjjpsv.js"),[]).then(a=>a.default),"../i18n/bg.json":()=>v(()=>import("./bg-DMHwWaHq.js"),[]).then(a=>a.default),"../i18n/bn.json":()=>v(()=>import("./bn-BMHg_6Cc.js"),[]).then(a=>a.default),"../i18n/bs.json":()=>v(()=>import("./bs-BQ6MYvQz.js"),[]).then(a=>a.default),"../i18n/ca.json":()=>v(()=>import("./ca-RJZ1kJCp.js"),[]).then(a=>a.default),"../i18n/cs.json":()=>v(()=>import("./cs-DUR8CfDR.js"),[]).then(a=>a.default),"../i18n/da.json":()=>v(()=>import("./da-C24v82sE.js"),[]).then(a=>a.default),"../i18n/de.json":()=>v(()=>import("./de-BdfGCsIh.js"),[]).then(a=>a.default),"../i18n/el.json":()=>v(()=>import("./el-BbeSS82J.js"),[]).then(a=>a.default),"../i18n/en-gb.json":()=>v(()=>import("./en-gb-CdanBkea.js"),[]).then(a=>a.default),"../i18n/en-us.json":()=>v(()=>import("./en-us-DGsNxWQW.js"),[]).then(a=>a.default),"../i18n/es.json":()=>v(()=>import("./es-BAvNIXnQ.js"),[]).then(a=>a.default),"../i18n/et.json":()=>v(()=>import("./et-BB2GC4z2.js"),[]).then(a=>a.default),"../i18n/fa.json":()=>v(()=>import("./fa-CLNQrKiD.js"),[]).then(a=>a.default),"../i18n/fi.json":()=>v(()=>import("./fi-C3bvOL2F.js"),[]).then(a=>a.default),"../i18n/fr.json":()=>v(()=>import("./fr-GKuwB6u6.js"),[]).then(a=>a.default),"../i18n/he.json":()=>v(()=>import("./he-dgw3ddFB.js"),[]).then(a=>a.default),"../i18n/hr.json":()=>v(()=>import("./hr-H7xnaszL.js"),[]).then(a=>a.default),"../i18n/hu.json":()=>v(()=>import("./hu-D5PQi6ht.js"),[]).then(a=>a.default),"../i18n/id.json":()=>v(()=>import("./id-C4V9iQKh.js"),[]).then(a=>a.default),"../i18n/is.json":()=>v(()=>import("./is-B36p4HLL.js"),[]).then(a=>a.default),"../i18n/it.json":()=>v(()=>import("./it-BYE8Pv4L.js"),[]).then(a=>a.default),"../i18n/ja.json":()=>v(()=>import("./ja-C_20UUx6.js"),[]).then(a=>a.default),"../i18n/ka.json":()=>v(()=>import("./ka-CNxn4HrL.js"),[]).then(a=>a.default),"../i18n/ko.json":()=>v(()=>import("./ko-C66lSvgy.js"),[]).then(a=>a.default),"../i18n/lt.json":()=>v(()=>import("./lt-CSQtJejA.js"),[]).then(a=>a.default),"../i18n/mn.json":()=>v(()=>import("./mn-OFyF7cuL.js"),[]).then(a=>a.default),"../i18n/nl.json":()=>v(()=>import("./nl-p6pls65L.js"),[]).then(a=>a.default),"../i18n/no.json":()=>v(()=>import("./no-ukJhddl5.js"),[]).then(a=>a.default),"../i18n/pl.json":()=>v(()=>import("./pl-BLhEwn5P.js"),[]).then(a=>a.default),"../i18n/pt-br.json":()=>v(()=>import("./pt-br-Bqj88eex.js"),[]).then(a=>a.default),"../i18n/pt-pt.json":()=>v(()=>import("./pt-pt-Bqj88eex.js"),[]).then(a=>a.default),"../i18n/ro.json":()=>v(()=>import("./ro-DIcQOJbf.js"),[]).then(a=>a.default),"../i18n/ru.json":()=>v(()=>import("./ru-CFk3STll.js"),[]).then(a=>a.default),"../i18n/sk.json":()=>v(()=>import("./sk-BVV3GKLZ.js"),[]).then(a=>a.default),"../i18n/sl.json":()=>v(()=>import("./sl-f5pM865d.js"),[]).then(a=>a.default),"../i18n/sq.json":()=>v(()=>import("./sq-BsCWVll4.js"),[]).then(a=>a.default),"../i18n/sr.json":()=>v(()=>import("./sr-BpAzoY7E.js"),[]).then(a=>a.default),"../i18n/sv.json":()=>v(()=>import("./sv-ifbbDt9U.js"),[]).then(a=>a.default),"../i18n/tr.json":()=>v(()=>import("./tr-CqPh9iY6.js"),[]).then(a=>a.default),"../i18n/uk.json":()=>v(()=>import("./uk-CBcda3hV.js"),[]).then(a=>a.default),"../i18n/vi.json":()=>v(()=>import("./vi-Lfa-VYGA.js"),[]).then(a=>a.default),"../i18n/zh-cn.json":()=>v(()=>import("./zh-cn-CFCd-XoD.js"),[]).then(a=>a.default),"../i18n/zh-hk.json":()=>v(()=>import("./zh-hk-BYHSteah.js"),[]).then(a=>a.default)});{if(!D[`../i18n/${d}.json`]){console.warn(`Vue Cal: the locale \`${d}\` does not exist. Falling back to \`en-us\`.`),d="en-us";return}D=await((m=D[`../i18n/${d}.json`])==null?void 0:m.call(D))}o.texts=Object.assign(o.texts,Object.assign({...N.texts},D)),O.updateTexts(o.texts)};let _=ne(n.events||[]);return G(()=>n.events,d=>_.splice(0,_.length,...d)),(n.locale||!o.texts.today)&&c(n.locale||"en-us"),{...pe(n),events:_,eventListeners:P,defaultView:H,availableViews:S,ready:Y,sm:F,xs:g,clickToNavigate:W,hideWeekdays:I,hideWeekends:T,minTimestamp:M,maxTimestamp:t,schedules:r,selectedDate:i,editableEvents:f,view:E,get hasHiddenDays(){return Object.keys(I.value).length},get size(){return g.value?"xs":F.value?"sm":"lg"},loadTexts:c}},Ie=(o,n)=>{const h=n.timeTo-n.timeFrom;return(o-n.timeFrom)*100/h},be=(o,n)=>{const h=n.timeTo-n.timeFrom;return~~(o*h/100+n.timeFrom)},ke=(o,n)=>{const h=n.clientHeight;return o*100/h},le=ne({id:null,date:null});let ve=!1,fe=!0;const Z=ne({el:null,cell:null,timeout:null}),B=ne({eventId:null,fromVueCal:null,toVueCal:null});function Oe(o){const{config:n,view:h,eventsManager:O,emit:Y,uid:E,dateUtils:F}=o,g=t=>{var m;const{timeStep:r,timeCellHeight:f,timeFrom:c}=n,_=(((m=t.touches)==null?void 0:m[0])||t).clientY,{top:d}=t.currentTarget.getBoundingClientRect(),D=_-d-~~t.dataTransfer.getData("cursor-grab-at");return be(ke(D,t.currentTarget),n)},W=(t,r,f)=>{const c=r.duration||P(r.start,r.end)||n.timeStep;let _=Math.max(g(t),0);if(n.snapToInterval){const a=_+n.snapToInterval/2;_=a-a%n.snapToInterval}const d=new Date(new Date(f).setMinutes(_)),D=Math.min(_+c,24*60),m=new Date(new Date(f).setMinutes(D));return{start:d,end:m}},P=(t,r)=>Math.round((r-t)/6e4);return{eventDragStart:(t,r)=>{if(console.log("eventDragStart"),t.target.nodeType===3||o.touch.isResizingEvent)return t.preventDefault();t.dataTransfer.dropEffect="move";const f={...r,_:{id:r._.id,duration:P(r.start,r.end)}};t.dataTransfer.setData("event",JSON.stringify(f)),t.dataTransfer.setData("cursor-grab-at",t.offsetY),B.eventId=r._.id,B.fromVueCal=E;const c=t.target.closest(".vuecal__event");c.classList.add("vuecal__event--dragging-ghost"),setTimeout(()=>{c.classList.add("vuecal__event--dragging-original"),c.classList.remove("vuecal__event--dragging-ghost")},0),ve=!1,Object.assign(le,{id:h.id,date:h.firstCellDate}),fe=!0,o.touch.isDraggingEvent=!0},eventDragEnd:(t,r)=>{console.log("eventDragEnd"),B.eventId=null,t.target.closest(".vuecal__event").classList.remove("vuecal__event--dragging-original");const{fromVueCal:f,toVueCal:c}=B;c&&f!==c&&O.deleteEvent(r._.id,3),B.fromVueCal=null,B.toVueCal=null,ve&&fe&&le.id&&h.switchView(le.id,le.date,!0),o.touch.isDraggingEvent=!1},cellDragEnter:(t,r)=>{const{start:f}=r;console.log("cellDragEnter");const c=t.currentTarget;if(!t.currentTarget.contains(t.relatedTarget)){if(c===Z.el||!c.className.includes("vuecal__cell-content"))return!1;Z.el&&(Z.cell.highlighted=!1),Object.assign(Z,{el:c,cell:r,timeout:clearTimeout(Z.timeout)}),r.highlighted=!0,["years","year","month"].includes(h.id)&&(Z.timeout=setTimeout(()=>o.switchToNarrowerView(f),2e3))}},cellDragOver:(t,r)=>{const{start:f,schedule:c}=r;console.log("cellDragOver"),t.preventDefault(),r.highlighted=!0,(c||c===0)&&(r.highlightedSchedule=c)},cellDragLeave:(t,r)=>{console.log("cellDragLeave"),t.preventDefault(),!t.currentTarget.contains(t.relatedTarget)&&(r.highlightedSchedule=!1,Z.cell===r&&(clearTimeout(Z.timeout),Object.assign(Z,{el:null,cell:null,timeout:null}),r.highlighted=!1))},cellDragDrop:async(t,r)=>{var k,L,x;t.preventDefault(),clearTimeout(Z.timeout),Object.assign(Z,{el:null,cell:null,timeout:null});const f=JSON.parse(t.dataTransfer.getData("event")||"{}");f.start&&(f.start=new Date(f.start)),f.end&&(f.end=new Date(f.end));let c;const{start:_,end:d}=W(t,f,r.start),{schedule:D}=((k=t.target.closest("[data-schedule]"))==null?void 0:k.dataset)||{};let m=()=>{};console.log("cellDragDrop",_,d,D,B.fromVueCal,E),B.fromVueCal===E?(c=O.getEvent(f._.id),c&&(c._.dragging=!1,m=()=>{c.start=_,c.end=d,D!==void 0&&(c.schedule=~~D)})):(c={...f,start:_,end:d,...D!==void 0&&{schedule:~~D},_:{id:((L=f._)==null?void 0:L.id)||f.id,duration:P(_,d)},getOverlappingEvents:()=>O.getEventsInRange(O.getEventsByDate(F.formatDate(_),!0),{start:_,end:d},{schedule:~~D})},m=()=>{c=O.createEvent(c)});let a=!0;const{drop:y}=(x=n.eventListeners)==null?void 0:x.event;y&&(a=await y({e:t,event:{...c,start:_,end:d,schedule:~~D},overlaps:c.getOverlappingEvents({start:_,end:d,schedule:~~D}),cell:r,external:B.fromVueCal!==E})),a!==!1&&m(),r.highlighted=!1,r.highlightedSchedule=null,fe=!1,B.toVueCal=E,Y("event-dropped",{event:c,originalEvent:f,external:B.fromVueCal!==E}),Y("event-change",{event:c,originalEvent:f})}}}const _e=o=>{let n,h,O,Y={},E={};const F=X(o),g=()=>{Date.prototype.addDays=function(e){return T(this,e||0)},Date.prototype.subtractDays=function(e){return S(this,e||0)},Date.prototype.addHours=function(e){return H(this,e||0)},Date.prototype.subtractHours=function(e){return i(this,e||0)},Date.prototype.addMinutes=function(e){return M(this,e||0)},Date.prototype.subtractMinutes=function(e){return t(this,e||0)},Date.prototype.getWeek=function(){return f(this)},Date.prototype.isToday=function(){return c(this)},Date.prototype.isLeapYear=function(){return D(this)},Date.prototype.format=function(e="YYYY-MM-DD"){return Q(this,e)},Date.prototype.formatTime=function(e="HH:mm"){return re(this,e)}},W=()=>{delete Date.prototype.addDays,delete Date.prototype.subtractDays,delete Date.prototype.addHours,delete Date.prototype.subtractHours,delete Date.prototype.addMinutes,delete Date.prototype.subtractMinutes,delete Date.prototype.getWeek,delete Date.prototype.isToday,delete Date.prototype.isLeapYear,delete Date.prototype.format,delete Date.prototype.formatTime},P=e=>F.value=e,I=()=>(h!==new Date().getDate()&&(n=new Date,h=n.getDate(),O=`${n.getFullYear()}-${n.getMonth()}-${n.getDate()}`),O),T=(e,u)=>{const s=new Date(e.valueOf());return s.setDate(s.getDate()+u),s},S=(e,u)=>{const s=new Date(e.valueOf());return s.setDate(s.getDate()-u),s},H=(e,u)=>{const s=new Date(e.valueOf());return s.setHours(s.getHours()+u),s},i=(e,u)=>{const s=new Date(e.valueOf());return s.setHours(s.getHours()-u),s},M=(e,u)=>{const s=new Date(e.valueOf());return s.setMinutes(s.getMinutes()+u),s},t=(e,u)=>{const s=new Date(e.valueOf());return s.setMinutes(s.getMinutes()-u),s},r=(e,u)=>{const s=b=>{const C=b%u;return C!==0&&(b+=C>=u/2?u-C:-C),b};if(typeof e=="number")return s(e);if(e instanceof Date){let b=s(e.getMinutes());b>=60&&(e.setHours(e.getHours()+1),b=0),e.setMinutes(b,0,0)}},f=(e,u=!1)=>{const s=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),b=s.getUTCDay()||7;s.setUTCDate(s.getUTCDate()+4-b);const C=new Date(Date.UTC(s.getUTCFullYear(),0,1));return Math.ceil(((s-C)/864e5+1)/7)+(u?1:0)},c=e=>`${e.getFullYear()}-${e.getMonth()}-${e.getDate()}`===I(),_=(e,u)=>{if(!e||!u)return console.warn(`Vue Cal: missing date${e?"2":"1"} parameter for comparison with \`isSameDate(date1, date2)\`.`);if(x(e)){if(!x(u))return console.warn(`Vue Cal: invalid date2 provided for comparison with \`isSameDate(date1, date2)\`: \`${u}\`.`)}else return console.warn(`Vue Cal: invalid date1 provided for comparison with \`isSameDate(date1, date2)\`: \`${e}\`.`);return e.getFullYear()===u.getFullYear()&&e.getMonth()===u.getMonth()&&e.getDate()===u.getDate()},d=(e,u,s)=>x(e)?e.getTime()>=u&&e.getTime()<=s:console.warn(`Vue Cal: invalid date provided to \`isInRange(date, rangeStart, rangeEnd)\`: \`${e}\`.`),D=e=>{const u=e.getFullYear();return!(u%400)||u%100&&!(u%4)},m=(e=null,u)=>{const s=e&&new Date(e.valueOf())||new Date,b=u?7:6;return s.setDate(s.getDate()-(s.getDay()+b)%7),s},a=e=>e instanceof Date?e:(e.length===10&&(e+=" 00:00"),new Date(e.replace(/-/g,"/"))),y=e=>e.getHours()*60+e.getMinutes(),k=(e,u)=>{typeof e=="string"&&(e=e.replace(/-/g,"/")),typeof u=="string"&&(u=u.replace(/-/g,"/")),e=new Date(e).setHours(0,0,0,0),u=new Date(u).setHours(0,0,1,0);const s=(new Date(u).getTimezoneOffset()-new Date(e).getTimezoneOffset())*60*1e3;return Math.ceil((u-e-s)/(24*3600*1e3))},L=(e,u,s)=>Math.abs(e.getTime()-u.getTime())<=s*60*1e3,x=e=>e&&e instanceof Date&&!isNaN(e),Q=(e,u="YYYY-MM-DD",s=null)=>{if(s||(s=F.value),u||(u="YYYY-MM-DD"),u==="YYYY-MM-DD")return q(e);Y={},E={};const b={YYYY:()=>A(e,s).YYYY,YY:()=>A(e,s).YY(),M:()=>A(e,s).M,MM:()=>A(e,s).MM(),MMM:()=>A(e,s).MMM(),MMMM:()=>A(e,s).MMMM(),MMMMG:()=>A(e,s).MMMMG(),D:()=>A(e,s).D,DD:()=>A(e,s).DD(),S:()=>A(e,s).S(),d:()=>A(e,s).d,dd:()=>A(e,s).dd(),ddd:()=>A(e,s).ddd(),dddd:()=>A(e,s).dddd(),HH:()=>z(e,s).HH,H:()=>z(e,s).H,hh:()=>z(e,s).hh,h:()=>z(e,s).h,am:()=>z(e,s).am,AM:()=>z(e,s).AM,mm:()=>z(e,s).mm,m:()=>z(e,s).m,s:()=>z(e,s).s};return u.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(C,J)=>{const $=b[J.replace(/\{|\}/g,"")];return $!==void 0?$():J})},q=e=>{const u=e.getMonth()+1,s=e.getDate();return`${e.getFullYear()}-${u<10?"0":""}${u}-${s<10?"0":""}${s}`},re=(e,u="HH:mm",s=null,b=!1)=>{let C=!1;if(b){const[U,ee,te]=[e.getHours(),e.getMinutes(),e.getSeconds()];U+ee+te===141&&(C=!0)}if(e instanceof Date&&u==="HH:mm")return C?"24:00":K(e);E={},s||(s=F.value);const J=z(e,s),$=u.replace(/(\{[a-zA-Z]+\}|[a-zA-Z]+)/g,(U,ee)=>{const te=J[ee.replace(/\{|\}/g,"")];return te!==void 0?te:ee});return C?$.replace("23:59","24:00"):$},K=e=>{const u=e.getHours(),s=e.getMinutes();return`${(u<10?"0":"")+u}:${(s<10?"0":"")+s}`},oe=e=>{const u=Math.floor(e/60).toString().padStart(2,0),s=(e%60).toString().padStart(2,0);return`${u}:${s}`},ue=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},A=(e,u)=>{if(Y.D)return Y;const s=e.getFullYear(),b=e.getMonth()+1,C=e.getDate(),$=(e.getDay()-1+7)%7;return Y={YYYY:s,YY:()=>s.toString().substring(2),M:b,MM:()=>b.toString().padStart(2,0),MMM:()=>u.months[b-1].substring(0,3),MMMM:()=>u.months[b-1],MMMMG:()=>(u.monthsGenitive||u.months)[b-1],D:C,DD:()=>C.toString().padStart(2,0),S:()=>ue(C),d:$+1,dd:()=>u.weekDaysShort.length?u.weekDaysShort[$]:u.weekDays[$][0],ddd:()=>u.weekDaysShort.length?u.weekDaysShort[$]:u.weekDays[$].substr(0,3),dddd:()=>u.weekDays[$]},Y},z=(e,u)=>{if(E.am)return E;let s,b,C;e instanceof Date?(s=e.getHours(),b=e.getMinutes(),C=e.getSeconds()):(s=Math.floor(e/60),b=Math.floor(e%60));const J=s%12?s%12:12,$=(u||{am:"am",pm:"pm"})[s===24||s<12?"am":"pm"];return E={H:s,h:J,HH:s.toString().padStart(2,0),hh:J.toString().padStart(2,0),am:$,AM:$.toUpperCase(),m:b,mm:b.toString().padStart(2,0),s:C},E};return{addDatePrototypes:g,removeDatePrototypes:W,updateTexts:P,addDays:T,subtractDays:S,addHours:H,subtractHours:i,addMinutes:M,subtractMinutes:t,snapToInterval:r,getWeek:f,isToday:c,isSameDate:_,isInRange:d,isLeapYear:D,getPreviousFirstDayOfWeek:m,stringToDate:a,dateToMinutes:y,countDays:k,datesInSameTimeStep:L,isValid:x,formatDate:Q,formatDateLite:q,formatTime:re,formatTimeLite:K,formatMinutes:oe}},Se=o=>{const{dateUtils:n,config:h}=o;let O=0;const Y=V(()=>{const i={byDate:{},recurring:[],multiday:[],byId:{}};return h.events.sort((t,r)=>t.start-r.start<0?-1:1).forEach(t=>{E(t),t._||(t._={}),t._.id=t._.id||++O,t.delete||(t.delete=r=>I(t._.id,r)),t._.deleting=!1,t._.deleted=!1,t.isOverlapping=(r=null)=>t.getOverlappingEvents(r).length,t.getOverlappingEvents=(r=null)=>{var f;return S(g(n.formatDate((r==null?void 0:r.start)||t.start),!0),{start:(r==null?void 0:r.start)||t.start,end:(r==null?void 0:r.end)||t.end},{excludeIds:[t._.id],schedule:(f=h.schedules)!=null&&f.length?~~((r==null?void 0:r.schedule)||t.schedule):null})},t._.register=r=>{t._.$el=r,t._.fireCreated&&(o.emit("event-created",t),delete t._.fireCreated)},t._.unregister=()=>t._.$el=null,i.byId[t._.id]=t,t.recurring?i.recurring.push(t._.id):t._.multiday?(i.multiday.push(t._.id),i.byDate[t._.startFormatted]||(i.byDate[t._.startFormatted]=[]),i.byDate[t._.startFormatted].push(t._.id)):(i.byDate[t._.startFormatted]||(i.byDate[t._.startFormatted]=[]),i.byDate[t._.startFormatted].push(t._.id))}),i}),E=i=>{if(typeof i.start=="string"&&(i.start=n.stringToDate(i.start)),typeof i.end=="string"&&(i.end=n.stringToDate(i.end)),i.start.setSeconds(0,0),i.end.setSeconds(0,0),isNaN(i.start)||isNaN(i.end)){isNaN(i.start)?console.error(`Vue Cal: invalid start date for event "${i.title}".`,i.start):console.error(`Vue Cal: invalid end date for event "${i.title}".`,i.end);return}else i.end.getTime()<i.start.getTime()&&console.error(`Vue Cal: invalid event dates for event "${i.title}". The event ends before it starts.`,i.start,i.end);i._||(i._={}),i._.multiday=!n.isSameDate(i.start,new Date(i.end.getTime()-1)),i._.startFormatted=n.formatDate(i.start),i._.startMinutes=~~n.dateToMinutes(i.start),i._.endMinutes=~~n.dateToMinutes(i.end);const M=i.start.getHours(),t=i.start.getMinutes().toString().padStart(2,0),r=i.end.getHours(),f=i.end.getMinutes().toString().padStart(2,0);i._.startTimeFormatted24=`${M.toString().padStart(2,0)}:${t}`,i._.startTimeFormatted12=`${M%12||12}${t?`:${t}`:""} ${M<12?"AM":"PM"}`,i._.endTimeFormatted24=`${r.toString().padStart(2,0)}:${f}`,i._.endTimeFormatted12=`${r%12||12}${f?`:${f}`:""} ${r<12?"AM":"PM"}`,i._.duration=Math.abs(~~((i.end-i.start)/6e4))},F=i=>Y.value.byId[i],g=(i,M=!1,t=!1)=>{let r=Y.value.byDate[i]||[];return r=M||t?r.map(F):r,t||(r=r.filter(f=>!f.background),M||(r=r.map(f=>f._.id))),r},W=i=>{console.log("👗","getViewEvents");const M={};return i.forEach(({startFormatted:t})=>{M[t]=[];const r=g(t,!1,!0);r.length&&M[t].push(...r)}),M},P=i=>{if(!i.start||!i.end){console.error("Vue Cal: Cannot create an event without valid start and end dates.");return}return h.snapToInterval&&(n.snapToInterval(i.start,h.snapToInterval),n.snapToInterval(i.end,h.snapToInterval)),i._||(i._={}),i._.id=++O,i._.fireCreated=!0,h.events.push(i),i},I=(i,M=0)=>{var f;if(!h.editableEvents.delete)return;if(!i)return console.warn(`Vue Cal: Cannot delete unknown event \`${i}\`.`);const t=h.events.findIndex(c=>c._.id===i);if(t===-1)return console.warn(`Vue Cal: Cannot delete unknown event \`${i}\`.`);const r=h.events[t];if(r.deletable===!1)return console.warn(`Vue Cal: Can't delete event \`${i}\` since it was explicitely set to \`delete: false\`.`);switch(M){case 0:r._.deleting?r._.deleted?h.events.splice(t,1):r._.deleted=!0:r._.deleting=!0;break;case 1:r._.deleting=!0,h.events[t]._.deleting=!0;break;case 2:r._.deleted=!0,h.events[t]._.deleted=!0,(f=r._.$el)==null||f.dispatchEvent(new CustomEvent("event-deleted",{detail:r._.id}));break;case 3:h.events.splice(t,1),console.log("😫","deleting the event!",r),o.emit("update:events",h.events),o.emit("event-delete",r);break}return!0},T=i=>{const M=g(i,!0);if(!M.length)return{cellOverlaps:{},longestStreak:0};let t={},r=[],f=0;M.sort((c,_)=>c.start-_.start||c.end-c.start-(_.end-_.start));for(const c of M){const _=c._.id;t[_]||(t[_]={overlaps:new Set,maxConcurrent:1,position:0}),r=r.filter(y=>y.end>c.start);let d=r.filter(y=>{var L;return(!((L=h.schedules)!=null&&L.length)||c.schedule===y.schedule)&&y.start<c.end}),D=new Set(d.map(y=>{var k;return((k=t[y._.id])==null?void 0:k.position)??0})),m=0;for(;D.has(m);)m++;t[_].position=m,r.push(c);let a=Math.max(1,...d.map(y=>{var k;return((k=t[y._.id])==null?void 0:k.maxConcurrent)??1}));t[_].maxConcurrent=Math.max(d.length+1,a);for(const y of d)t[y._.id].overlaps.add(_),t[_].overlaps.add(y._.id),t[y._.id].maxConcurrent=t[_].maxConcurrent;f=Math.max(f,t[_].maxConcurrent)}for(const c in t)t[c].overlaps=[...t[c].overlaps];return{cellOverlaps:t,longestStreak:f}},S=(i=[],{start:M,end:t},{excludeIds:r=[],schedule:f=null})=>{var d;const c=new Set(r),_=[];for(const D of i)!c.has((d=D._)==null?void 0:d.id)&&(f===null||f===D.schedule)&&H(D,M,t)&&_.push(D);return _},H=(i,M,t)=>{const r=i.allDay||!h.time,f=r?new Date(i.start).setHours(0,0,0,0):i.start.getTime(),c=r?new Date(i.end).setHours(23,59,59,999):i.end.getTime(),_=r?new Date(M).setHours(0,0,0,0):M.getTime(),d=r?new Date(t).setHours(23,59,59,999):t.getTime();return c>_&&f<d};return{events:Y,getEvent:F,getEventsByDate:g,getViewEvents:W,getCellOverlappingEvents:T,getEventsInRange:S,createEvent:P,deleteEvent:I,isEventInRange:H}},Ye=({config:o,dateUtils:n,emit:h,texts:O,eventsManager:Y},E)=>{const{availableViews:F}=o,g=X(o.view&&F[o.view]?o.view:o.defaultView),W=X(o.selectedDate||null);let P=X(new Date);const I=X(new Date(o.viewDate||P.value));I.value.setHours(0,0,0,0);const T=X(new Date(I));let S=null;const H=V(()=>g.value==="month"?T.value:m.value),i=V(()=>g.value==="month"?new Date(T.value.getFullYear(),T.value.getMonth()+1,0,23,59,59,999):y.value),M=V(()=>g.value==="week"?n.getPreviousFirstDayOfWeek(m.value,o.startWeekOnSunday):g.value==="month"?m.value:H.value),t=V(()=>{if(g.value==="week"){const l=n.addDays(M.value,7);return l.setMilliseconds(-1),l}else if(g.value==="month")return y.value;return i.value}),r=V(()=>{const l=P.value.getTime();if(g.value==="week")return M.value.getTime()<=l&&l<=t.value.getTime();const w=m.value.getTime(),p=y.value.getTime();return w<=l&&l<=p});function f(){P.value=new Date,S=setTimeout(f,60*1e3)}function c(){S=setTimeout(f,(60-new Date().getSeconds())*1e3),f()}const _=V(()=>{if(!o.availableViews[g.value])return 1;let l=o.availableViews[g.value].cols;return o.hasHiddenDays&&["week","month"].includes(g.value)&&(l-=o.hasHiddenDays),l}),d=V(()=>{var l;return((l=o.availableViews[g.value])==null?void 0:l.rows)||1}),D=V(()=>_.value*d.value),m=V(()=>{if(g.value==="month"){let l=T.value.getDay()||7;return o.startWeekOnSunday&&!o.hideWeekdays[7]&&(l+=1),o.viewDayOffset&&(l-=o.viewDayOffset),n.subtractDays(T.value,l-1)}else if(g.value==="week"){const l="1234567".split("").filter(p=>!Object.keys(o.hideWeekdays).includes(p));let w=Math.min(...l);return o.startWeekOnSunday&&!o.hideWeekdays[7]&&(w=1),o.viewDayOffset&&(w+=o.viewDayOffset),n.addDays(T.value,w-1)}else return T.value}),a=V(()=>{console.log("recomputing view dates");const l=[],w=["days","week","month"].includes(g.value);let p=0;for(let j=0;j<D.value+p;j++)switch(g.value){case"day":case"days":case"week":case"month":{const R=n.addDays(m.value,j),ie=R.getDay()||7;if(w&&o.hasHiddenDays&&o.hideWeekdays[ie]){p++;continue}const se=new Date(R);se.setHours(23,59,59,999),l.push({start:R,startFormatted:n.formatDate(R),end:se});break}case"year":l.push({start:new Date(m.value.getFullYear(),j,1,0,0,0,0),end:new Date(m.value.getFullYear(),j+1,0,23,59,59,999)});break;case"years":l.push({start:new Date(m.value.getFullYear()+j,0,1,0,0,0,0),end:new Date(m.value.getFullYear()+j+1,0,0,23,59,59,999)});break}return l}),y=V(()=>a.value[a.value.length-1].end),k=X("right"),L=V(()=>{const l=Object.keys(o.availableViews);return l[l.indexOf(g.value)+1]}),x=V(()=>{const l=Object.keys(o.availableViews);return l[l.indexOf(g.value)-1]}),Q=V(()=>{const{dateFormat:l,truncations:w}=O;switch(g.value){case"day":return n.formatDate(m.value,l);case"days":{let p=l.replace(/(\s|^)[^a-zA-Z]*?d{2,4}[^a-zA-Z]*?(\s|$)/,"");w!==!1&&(p=p.replace("MMMM","MMM"));const j=n.formatDate(m.value,p),R=n.formatDate(y.value,p);return`${j} - ${R}`}case"week":{let p=n.getWeek(m.value,o.startWeekOnSunday&&!o.hideWeekdays[7]);p=` <small>${O.week} ${p}</small>`;const j=m.value.getMonth(),R=m.value.getFullYear(),ie=y.value.getMonth(),se=y.value.getFullYear(),de=j!==ie,ye=de&&R!==se,me=w!==!1&&(o.xs||de),ce=O.months[j][me?"substring":"toString"](0,3);if(de){const ge=O.months[ie][me?"substring":"toString"](0,3);return ye?`${ce} ${R} - ${ge} ${se} ${p}`:`${ce} - ${ge} ${R} ${p}`}else return`${ce} ${R} ${p}`}case"month":{const p=`${o.xs&&w!==!1?"MMM":"MMMM"} YYYY`;return n.formatDate(H.value,p)}case"year":return m.value.getFullYear();case"years":return`${m.value.getFullYear()} - ${i.value.getFullYear()}`}});function q(){switch(T.value=new Date(I.value||P.value),T.value.setHours(0,0,0,0),g.value){case"day":break;case"days":break;case"week":T.value=n.getPreviousFirstDayOfWeek(T.value,o.startWeekOnSunday&&!o.hideWeekdays[7]);break;case"month":T.value=new Date(T.value.getFullYear(),T.value.getMonth(),1,0,0,0,0);break;case"year":T.value=new Date(T.value.getFullYear(),0,1,0,0,0,0);break;case"years":T.value=new Date(T.value.getFullYear()-T.value.getFullYear()%D.value,0,1,0,0,0,0);break}console.log("🙆‍♂️","updateView",T.value),h("view-change",{id:g.value,title:Q.value,start:H.value,end:i.value,extendedStart:M.value,extendedEnd:t.value,cellDates:a.value,containsToday:r.value,events:De.value}),P.value=new Date}function re(l){const w=g.value,p=o.availableViews[w];l[w]&&JSON.stringify(l[w])===JSON.stringify(p)||q()}function K(l,w=!0){const p=Object.keys(o.availableViews);g.value!==l&&(p.includes(l)?(k.value=p.indexOf(l)<p.indexOf(g.value)?"left":"right",g.value=l,h("update:view",l),q()):console.warn(`Vue Cal: the \`${l}\` view is not available.`))}function oe(){L.value?K(L.value):console.warn("Vue Cal: no broader view is available.")}function ue(){x.value?K(x.value):console.warn("Vue Cal: no narrower view is available.")}function A(){e(!1)}function z(){e(!0)}function e(l=!0){let w=new Date(I.value);switch(g.value){case"day":case"days":l?w=n.addDays(y.value,1):w=n.subtractDays(m.value,D.value);break;case"week":{l?(w=n.addDays(t.value,1),w.setHours(0,0,0,0)):w=n.subtractDays(M.value,D.value);break}case"month":{const p=l?1:-1;w=new Date(w.getFullYear(),w.getMonth()+p,1,0,0,0,0);break}case"year":{const p=l?1:-1;w=new Date(w.getFullYear()+p,1,1,0,0,0,0);break}case"years":{const p=l?D.value:-D.value;w=new Date(w.getFullYear()+p,1,1,0,0,0,0);break}}s(w)}function u(){const l=new Date;l.setHours(0,0,0,0),s(l)}function s(l,w=!0,p=!1){if(!n.isValid(l))return console.warn("Vue Cal: can't navigate to the given date: invalid date provided to `updateViewDate(date)`.");let[j,R]=[m.value,y.value];g.value==="month"&&([j,R]=[H.value,i.value]),(!n.isInRange(l,j,R)||p)&&(l.setHours(0,0,0,0),k.value=l.getTime()<j.getTime()?"left":"right",I.value=l,w&&h("update:viewDate",l),q())}function b(l,w=!0){if(n.isValid(l)){const{isValid:p,isSameDate:j}=n;(!W.value||!p(W.value)||!j(l,W.value))&&(l.setHours(0,0,0,0),W.value=l,w&&h("update:selectedDate",l))}else return console.warn("Vue Cal: can't update the selected date: invalid date provided to `updateSelectedDate(date)`.")}function C(l){!l&&!T.value.getDay()?s(n.addDays(T.value,1),!0,!0):(k.value="left",q())}function J(l){console.log("😮",l,o.startWeekOnSunday,T.value),l&&o.startWeekOnSunday&&!T.value.getDay()?s(n.addDays(T.value,1),!0,!0):!l&&o.startWeekOnSunday&&T.value.getDay()===1&&s(n.subtractDays(T.value,1),!0,!0)}function $(){console.log("toggling weekdays",o.hideWeekdays)}function U(l){const w=E.value.querySelector(".vuecal__scrollable"),p=l?l*o.timeCellHeight/o.timeStep:0;w==null||w.scrollTo({top:p,behavior:"smooth"})}function ee(){const l=new Date;U(l.getHours()*60+l.getMinutes())}function te(){U(0)}const De=V(()=>Y.getViewEvents(a.value)),he=Y.createEvent,we=Y.deleteEvent;return G(()=>o.view,l=>K(l,!1)),G(()=>o.availableViews,re),G(()=>o.datePicker,()=>K("month",!1)),G(()=>o.viewDate,l=>s(l,!1)),G(()=>o.selectedDate,l=>b(l,!1)),G(()=>o.startWeekOnSunday,l=>C(l)),G(()=>o.hideWeekends,l=>J(l)),G(()=>o.hideWeekdays,$),G(()=>D.value,()=>{D.value>90&&console.warn("Vue Cal: high cell count detected. Performance may degrade when interactions are enabled.")}),G(()=>o.watchRealTime,l=>{l&&o.time?c():S=clearTimeout(S)}),q(),o.time&&o.watchRealTime&&c(),Te(()=>S=clearTimeout(S)),{now:P,id:g,broaderView:L,narrowerView:x,title:Q,viewDate:I,start:H,end:i,extendedStart:M,extendedEnd:t,firstCellDate:m,lastCellDate:y,containsToday:r,selectedDate:W,cellDates:a,cols:_,rows:d,events:De,transitionDirection:k,switch:K,broader:oe,narrower:ue,previous:A,next:z,navigate:e,goToToday:u,updateViewDate:s,updateSelectedDate:b,scrollToCurrentTime:ee,scrollToTime:U,scrollTop:te,createEvent:he,deleteEvent:we,get isDay(){return g.value==="day"},get isDays(){return g.value==="days"},get isWeek(){return g.value==="week"},get isMonth(){return g.value==="month"},get isYear(){return g.value==="year"},get isYears(){return g.value==="years"}}},ae=ne({texts:{...N.texts},dateUtils:_e(N.texts)}),$e=({props:o,emit:n,attrs:h,vuecalEl:O,uid:Y})=>{const E=ne({uid:Y,emit:n,texts:{...ae.texts},dateUtils:{...ae.dateUtils},now:new Date,config:{},eventsManager:{},view:{},dnd:{},touch:{isDraggingCell:!1,isDraggingEvent:!1,isResizingEvent:!1}});return E.dateUtils=_e(Object.assign(N.texts,E.texts)),E.config=Ve(E,o,h),E.eventsManager=Se(E),E.view=Ye(E,O),E.dnd=Oe(E),E},Pe=o=>{ae.texts={...N.texts,...o},ae.dateUtils.updateTexts(ae.texts)},{addDatePrototypes:Le,removeDatePrototypes:Ae,updateTexts:He,addDays:Re,subtractDays:Fe,addHours:We,subtractHours:xe,addMinutes:Ne,subtractMinutes:ze,getWeek:Ze,isToday:Be,isSameDate:Ge,isInRange:Je,isLeapYear:qe,getPreviousFirstDayOfWeek:Ke,stringToDate:Qe,dateToMinutes:Xe,countDays:Ue,datesInSameTimeStep:et,isValid:tt,formatDate:at,formatDateLite:nt,formatTime:st,formatTimeLite:rt,formatMinutes:it}=ae.dateUtils;export{Re as a,Le as b,je as c,ke as d,$e as e,at as f,Ie as m,be as p,Qe as s,Pe as u,Me as w};
