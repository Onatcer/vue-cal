import{l as ve,c as k,b as f,d as u,K as _,q as P,g,F as X,j as K,i as U,e as H,f as oe,w as C,A as te,L as Te,y as j,H as fe,M as V,N as F,T as ye,t as R,n as G,r as ee,x as he,o as ke,O as $e,m as Me,D as Ne,I as _e,h as Ee,z as re,P as Ye,Q as Ae,R as Ve,S as Fe,U as Re}from"./index-CqqBfYAe.js";import{w as pe,m as ne,p as ce,d as Ie,e as Ce,u as He}from"./index-C5jIeMqK.js";const We=24*60,je={allDayEvents:{type:[Boolean,String],default:!1},stackEvents:{type:Boolean,default:!1},clickToNavigate:{type:Boolean,default:void 0},dark:{type:Boolean,default:!1},datePicker:{type:Boolean,default:!1},disableDays:{type:Array,default:()=>[]},editableEvents:{type:[Boolean,Object],default:!1},eventCreateMinDrag:{type:Number,default:15},events:{type:Array,default:()=>[]},eventCount:{type:Boolean,default:!1},eventsOnMonthView:{type:Boolean,default:!1},hideWeekdays:{type:Array,default:()=>[]},hideWeekends:{type:Boolean,default:!1},locale:{type:String,default:""},maxDate:{type:[String,Date],default:""},minDate:{type:[String,Date],default:""},selectedDate:{type:[String,Date],default:""},sm:{type:Boolean,default:!1},specialHours:{type:Object,default:()=>({})},schedules:{type:Array,default:()=>[]},snapToInterval:{type:Number,default:0},startWeekOnSunday:{type:Boolean,default:!1},theme:{type:[String,Boolean],default:"default"},time:{type:Boolean,default:!0},timeAtCursor:{type:Boolean,default:!1},timeCellHeight:{type:Number,default:40},timeFormat:{type:String,default:""},timeFrom:{type:Number,default:0},timeStep:{type:Number,default:60},timeTo:{type:Number,default:We},titleBar:{type:Boolean,default:!0},todayButton:{type:Boolean,default:!0},twelveHour:{type:Boolean,default:!1},view:{type:String,default:""},viewDate:{type:[String,Date],default:""},viewDayOffset:{type:Number,default:0},views:{type:[Array,Object]},viewsBar:{type:Boolean,default:!0},watchRealTime:{type:Boolean,default:!1},weekNumbers:{type:Boolean,default:!1},xs:{type:Boolean,default:!1}},Ue={class:"vuecal__header"},qe={key:0,class:"vuecal__views-bar"},Ge=["onClick","innerHTML"],Ke={key:1,class:"vuecal__title-bar"},Qe={class:"vuecal__transition-wrap"},Je=["disabled","innerHTML"],Ze={__name:"header",setup(Q){const b=ve("vuecal"),{view:l,config:a}=b,o=()=>{a.clickToNavigate&&l.broader()},y=k(()=>a.clickToNavigate?{click:o}:{});return(Y,m)=>(u(),f("div",Ue,[_(Y.$slots,"header",{view:g(l),availableViews:g(a).availableViews,vuecal:g(b)}),Y.$slots.header?P("",!0):(u(),f(X,{key:0},[g(a).viewsBar?(u(),f("div",qe,[(u(!0),f(X,null,K(g(a).availableViews,(D,t)=>(u(),f("button",{class:U(["vuecal__view-button",{"vuecal__view-button--active":g(l).id===t}]),onClick:s=>g(l).switch(t),innerHTML:g(b).texts[t],type:"button"},null,10,Ge))),256))])):P("",!0),g(a).titleBar?(u(),f("nav",Ke,[H("button",{class:U(["vuecal__nav vuecal__nav--prev",{"vuecal__nav--default":!Y.$slots["previous-button"]}]),onClick:m[0]||(m[0]=(...D)=>g(l).previous&&g(l).previous(...D)),type:"button"},[_(Y.$slots,"previous-button")],2),H("div",Qe,[oe(ye,{name:`vuecal-slide-fade--${g(l).transitionDirection}`},{default:C(()=>[(u(),f("div",{key:g(l).id+g(l).start.getTime()},[Y.$slots.title?(u(),te(Te(g(a).clickToNavigate&&g(l).broaderView?"button":"div"),j({key:0,class:"vuecal__title"},fe(y.value)),{default:C(()=>[_(Y.$slots,"title",V(F(g(l))))]),_:3},16)):(u(),te(Te(g(a).clickToNavigate&&g(l).broaderView?"button":"div"),j({key:1,class:"vuecal__title"},fe(y.value),{innerHTML:g(l).title}),null,16,["innerHTML"]))]))]),_:3},8,["name"])]),g(a).todayButton?(u(),f(X,{key:0},[Y.$slots["today-button"]?_(Y.$slots,"today-button",{key:0,navigate:()=>!g(l).containsToday&&g(l).goToToday(),active:g(l).containsToday}):(u(),f("button",{key:1,class:U(["vuecal__nav vuecal__nav--today vuecal__nav--default",{"vuecal__nav--active":g(l).containsToday}]),onClick:m[1]||(m[1]=D=>!g(l).containsToday&&g(l).goToToday()),disabled:!!g(l).containsToday,type:"button",innerHTML:g(b).texts.today},null,10,Je))],64)):P("",!0),H("button",{class:U(["vuecal__nav vuecal__nav--next",{"vuecal__nav--default":!Y.$slots["next-button"]}]),onClick:m[2]||(m[2]=(...D)=>g(l).next&&g(l).next(...D)),type:"button"},[_(Y.$slots,"next-button")],2)])):P("",!0)],64))]))}},xe={key:0,class:"vuecal__headings"},et={key:0,class:"vuecal__weekdays-headings"},tt=["onClick"],st={class:"vuecal__weekday-day"},lt={key:0,class:"vuecal__weekday-date"},at={key:1,class:"vuecal__schedules-headings w-flex grow"},nt=["innerHTML"],ot={__name:"headings-bar",setup(Q){const b=ve("vuecal"),{view:l,config:a,dateUtils:o}=b,y=k(()=>a.xs?"day-xs":a.sm||l.isDays||l.isMonth?"day-sm":"day"),Y=k(()=>(l.isDay||l.isDays||l.isWeek||l.isMonth)&&!(l.isDay&&!a.schedules)),m=k(()=>l.cellDates.slice(0,l.cols).map(({start:t})=>({id:pe[t.getDay()],date:t,dateNumber:t.getDate(),day:o.formatDate(t,"dddd"),"day-sm":o.formatDate(t,"ddd"),"day-xs":o.formatDate(t,"dd"),isToday:o.isToday(t)}))),D={click:t=>{(l.isDays||l.isWeek)&&l.updateSelectedDate(t)}};return(t,s)=>Y.value?(u(),f("div",xe,[g(l).isDay?P("",!0):(u(),f("div",et,[(u(!0),f(X,null,K(m.value,(w,B)=>(u(),f("div",{class:U(["vuecal__weekday",{"vuecal__weekday--today":w.isToday}]),key:B,onClick:O=>D.click(w.date)},[_(t.$slots,"weekday-heading",{label:w[y.value],id:w.id,date:w.date},()=>[H("span",st,R(w[y.value]),1),g(l).isMonth?P("",!0):(u(),f("strong",lt,R(w.dateNumber),1))])],10,tt))),128))])),g(a).schedules?(u(),f("div",at,[(u(!0),f(X,null,K(m.value,(w,B)=>(u(),f(X,{key:B},[(u(!0),f(X,null,K(g(a).schedules,(O,I)=>(u(),f(X,{key:I},[t.$slots["schedule-heading"]?(u(),f("div",{key:0,class:U(["vuecal__schedule vuecal__schedule--heading",O.class])},[_(t.$slots,"schedule-heading",{schedule:O,view:g(l)})],2)):(u(),f("div",{key:1,class:U(["vuecal__schedule vuecal__schedule--heading",O.class]),innerHTML:O.label},null,10,nt))],64))),128))],64))),128))])):P("",!0)])):P("",!0)}},rt={class:"vuecal__time-column"},it={__name:"time-column",setup(Q){const b=ve("vuecal"),{config:l,texts:a}=b,o=k(()=>{const y=[];for(let m=l.timeFrom;m<l.timeTo;m+=l.timeStep){const D=m+l.timeStep>l.timeTo,t=~~(m/60),s=m%60,w=a[m<720?"am":"pm"];let B=null;D&&(B=`calc(var(--vuecal-time-cell-height) * ${(l.timeTo-m)/l.timeStep})`),y.push({minutesSum:m,hours:t,minutes:s,formatted12:`${t%12?t%12:12}${s?`:${s.toString().padStart(2,0)}`:""}${w}`,formatted24:`${t.toString().padStart(2,0)}:${s.toString().padStart(2,0)}`,height:B})}return y});return(y,Y)=>(u(),f("div",rt,[(u(!0),f(X,null,K(o.value,(m,D)=>(u(),f("div",{class:"vuecal__time-cell",key:D,style:G({height:m.height||null})},[_(y.$slots,"time-cell",{index:D,minutes:m.minutes,hours:m.hours,minutesSum:m.minutesSum,format12:m.formatted12,format24:m.formatted24},()=>[H("label",null,R(g(l).twelveHour?m.formatted12:m.formatted24),1)])],4))),128))]))}},ut=["draggable"],ct={class:"vuecal__event-details"},vt={class:"vuecal__event-title"},dt={key:0,class:"vuecal__event-time"},mt=["innerHTML"],Pe={__name:"event",props:{event:{type:Object,required:!0}},emits:["event-drag-start","event-drag-end","event-resize-start","event-resize-end"],setup(Q,{emit:b}){const{config:l,view:a,dnd:o,touch:y,dateUtils:Y}=ve("vuecal"),m=Q,D=ee(null),t=he(m.event),s=he({dragging:!1,resizing:!1,fromResizer:!1,holding:!1,holdTimer:null,startX:0,startY:0,startPercentageX:0,startPercentageY:0,moveX:0,moveY:0,movePercentageX:0,movePercentageY:0,resizeStartDate:null,resizingOriginalEvent:null,resizingLastAcceptedEvent:null,cellEl:null,schedule:null}),w=k(()=>l.editableEvents.drag&&t.draggable!==!1&&!t.background),B=k(()=>l.time&&l.editableEvents.resize&&t.resizable!==!1&&!t.background);k(()=>l.editableEvents.delete&&t.deletable!==!1&&!t.background);const O=k(()=>{var h,c,T;return{[`vuecal__event--${t._.id}`]:!0,[t.class]:!!t.class,"vuecal__event--recurring":!!t.recurring,"vuecal__event--background":!!t.background,"vuecal__event--multiday":!!((h=t._)!=null&&h.multiday),"vuecal__event--cut-top":((c=t._)==null?void 0:c.startMinutes)<l.timeFrom,"vuecal__event--cut-bottom":((T=t._)==null?void 0:T.endMinutes)>l.timeTo||t.end.getDate()!==t.start.getDate(),"vuecal__event--dragging":!t._.draggingGhost&&t._.dragging,"vuecal__event--dragging-ghost":t._.draggingGhost,"vuecal__event--resizing":s.resizing}}),I=k(()=>{const h=(a.isDay||a.isDays||a.isWeek)&&l.time;if(!h&&!t.backgroundColor&&!t.color)return!1;const c={backgroundColor:t.backgroundColor||null,color:t.color||null};if(h){const T=Math.max(l.timeFrom,t._.startMinutes),M=Math.min(l.timeTo,t._.endMinutes),z=ne(T,l),L=ne(M,l)-z;c.top=`${z}%`,c.height=`${L}%`}return c}),n=k(()=>{const h={...l.eventListeners.event};for(const[M,z]of Object.entries(h))["resize-end"].includes(M)||(h[M]=L=>{L.type!=="drop"&&z(L.type?{e:L,event:t}:L)});const c={...h};h.touchstart=M=>{var z;M.stopPropagation(),d(M),(z=c.touchstart)==null||z.call(c,{e:M,event:t})},h.mousedown=M=>{var z;M.stopPropagation(),d(M),(z=c.mousedown)==null||z.call(c,{e:M,event:t})};let T=null;return h.click=M=>{var z;(z=c.click)==null||z.call(c,{e:M,event:t}),T?T=clearTimeout(T):T=setTimeout(()=>{var L;T=null,(L=c["delayed-click"])==null||L.call(c,{e:M,event:t})},400)},h.dblclick=M=>{c.dblclick?c.dblclick({e:M,event:t}):t.delete(1)},h}),d=h=>{var M,z,L;const c=((M=h.touches)==null?void 0:M[0])||h;s.fromResizer=c.target.matches(".vuecal__event-resizer, .vuecal__event-resizer *");const T=D.value.getBoundingClientRect();s.startX=(((z=h.touches)==null?void 0:z[0])||h).clientX-T.left,s.startY=(((L=h.touches)==null?void 0:L[0])||h).clientY-T.top,s.startPercentageX=s.startX*100/T.width,s.startPercentageY=s.startY*100/T.height,s.cellEl=D.value.closest(".vuecal__cell"),s.resizeStartDate=t.start,de(h.type==="touchstart"?"touchmove":"mousemove",W),de(h.type==="touchstart"?"touchend":"mouseup",p,{once:!0}),s.holdTimer=setTimeout(()=>{var N,q;s.holding=!0,(q=(N=n.value).hold)==null||q.call(N,{e:h,event:t})},1e3)},W=async h=>{var T,M,z,L;const c=((T=h.touches)==null?void 0:T[0])||h;if(s.fromResizer&&!s.resizing&&(s.resizing=!0,s.resizingOriginalEvent={...t,_:{...t._}},y.isResizingEvent=!0,(z=(M=n.value).resizeStart)==null||z.call(M,{e:h,event:t})),s.holdTimer=clearTimeout(s.holdTimer),s.holding=!1,s.cellEl){const{top:N,left:q,width:se,height:Z}=s.cellEl.getBoundingClientRect();s.moveX=c.clientX-q,s.moveY=c.clientY-N,s.movePercentageX=s.moveX*100/se,s.movePercentageY=s.moveY*100/Z}if(s.fromResizer){const{newStart:N,newEnd:q}=ie(t);let se=!0;const{resize:Z}=(L=l.eventListeners)==null?void 0:L.event;Z&&(se=await Z({e:h,event:{...t,start:N,end:q},overlaps:t.getOverlappingEvents({start:N,end:q})})),se!==!1?(t.start=N,t.end=q,s.resizingLastAcceptedEvent&&(s.resizingLastAcceptedEvent=null)):Z&&(s.resizingLastAcceptedEvent={...t,_:{...t._}})}},p=async h=>{var c,T;if(s.holdTimer=clearTimeout(s.holdTimer),s.holding=!1,s.resizing){const{newStart:M,newEnd:z}=ie(t);let L=!0;const N=n.value["resize-end"];N&&(L=await N({e:h,event:t,original:s.resizingOriginalEvent,overlaps:t.getOverlappingEvents({start:M,end:z})})),t.start=L===!1?(s.resizingLastAcceptedEvent||s.resizingOriginalEvent).start:((c=s.resizingLastAcceptedEvent)==null?void 0:c.start)||M,t.end=L===!1?(s.resizingLastAcceptedEvent||s.resizingOriginalEvent).end:((T=s.resizingLastAcceptedEvent)==null?void 0:T.end)||z,t._.duration<1&&(t.start=s.resizingOriginalEvent.start,t.end=s.resizingOriginalEvent.end),y.isResizingEvent=!1}document.removeEventListener(h.type==="touchend"?"touchmove":"mousemove",W),s.resizing=!1,s.fromResizer=!1,s.dragging=!1,s.startX=0,s.startY=0,s.moveX=0,s.moveY=0,s.startPercentageX=0,s.startPercentageY=0,s.movePercentageX=0,s.movePercentageY=0,s.cellEl=null,s.resizeStartDate=null,s.resizingOriginalEvent=null,s.resizingLastAcceptedEvent=null,s.schedule=null},ie=h=>{const c=new Date(h.start.getFullYear(),h.start.getMonth(),h.start.getDate());new Date(c).setDate(c.getDate()+1);let M=ce(s.movePercentageY,l);if(M=Math.max(0,Math.min(M,24*60)),l.snapToInterval){const N=M+l.snapToInterval/2;M=N-N%l.snapToInterval}let z=h.start,L=new Date(c.getTime()+M*6e4);return L<s.resizeStartDate&&(z=L,L=s.resizeStartDate),{newStart:z,newEnd:L}};ke(()=>t._.register(D.value));const me=[],de=(h,c,T)=>{document.addEventListener(h,c,T),me.push({event:h,handler:c,options:T})};return $e(()=>{t._.unregister();for(const{event:h,handler:c,options:T}of me)document.removeEventListener(h,c,T)}),(h,c)=>(u(),f("div",j({class:"vuecal__event"},fe(n.value,!0),{ref_key:"eventEl",ref:D,class:O.value,style:I.value,draggable:w.value?"true":void 0,onDragstart:c[2]||(c[2]=T=>w.value&&g(o).eventDragStart(T,t)),onDragend:c[3]||(c[3]=T=>w.value&&g(o).eventDragEnd(T,t))}),[H("div",ct,[_(h.$slots,"event",{event:t},()=>[H("div",vt,R(t.title),1),g(l).time?(u(),f("div",dt,R(t._[`startTimeFormatted${g(l).twelveHour?12:24}`])+`
- `+R(t._[`endTimeFormatted${g(l).twelveHour?12:24}`]),1)):P("",!0),H("div",{class:"vuecal__event-content",innerHTML:t.content},null,8,mt)])]),B.value?(u(),f("div",{key:0,class:"vuecal__event-resizer",onDragstart:c[0]||(c[0]=Me(()=>{},["prevent","stop"]))},null,32)):P("",!0),oe(ye,{name:"vuecal-delete-btn"},{default:C(()=>[t._.deleting?(u(),f("div",{key:0,class:"vuecal__event-delete",onClick:c[1]||(c[1]=Me(T=>t.delete(3),["stop"]))},"Delete")):P("",!0)]),_:1})],16,ut))}},gt=["innerHTML"],ft=["data-schedule"],ht={key:1,class:"vuecal__cell-date"},yt={key:2,class:"vuecal__cell-content"},_t={key:3,class:"vuecal__cell-events"},pt={key:1,class:"vuecal__cell-date"},kt={key:2,class:"vuecal__cell-content"},$t={key:3,class:"vuecal__cell-events"},wt={key:5,class:"vuecal__cell-events-count"},bt=["title"],Dt={__name:"cell",props:{start:{type:Date,required:!0},end:{type:Date,required:!0},index:{type:Number,required:!0}},setup(Q){const b=Q,l=ve("vuecal"),{view:a,config:o,dateUtils:y,eventsManager:Y,dnd:m,touch:D}=l,t=k(()=>y.isToday(b.start)),s=ee(null),w=ee([]),B=ee(!1),O=e=>{w.value.push(e.detail),B.value=!0},I=()=>setTimeout(()=>B.value=!1,300),n=he({dragging:!1,holding:!1,holdTimer:null,thresholdPassed:!1,startX:0,startY:0,moveX:0,moveY:0,startPercentageX:0,startPercentageY:0,movePercentageX:0,movePercentageY:0,schedule:null}),d=ee(!1),W=ee({cellOverlaps:{},longestStreak:0}),p=k(()=>{let e=Math.min(n.startPercentageY,n.movePercentageY),r=Math.max(n.startPercentageY,n.movePercentageY),v=ce(e,o),i=ce(r,o);return o.snapToInterval&&(v=y.snapToInterval(v,o.snapToInterval),i=y.snapToInterval(i,o.snapToInterval),e=ne(v,o),r=ne(i,o)),{style:{top:`${e}%`,height:`${Math.abs(r-e)}%`},startMinutes:v,endMinutes:i,start:y.formatMinutes(v),end:y.formatMinutes(i),...n.schedule?{schedule:n.schedule}:{}}}),ie=k(()=>{const e=o.editableEvents.create&&(n.dragging||d.value),r=o.eventCreateMinDrag&&n.thresholdPassed||!o.eventCreateMinDrag;return e&&r}),me=k(()=>{var A;const e=new Date,r=a.start.getFullYear(),v=a.start.getMonth(),i=b.start.getFullYear(),$=b.start.getMonth();return{[`vuecal__cell--${pe[b.start.getDay()]}`]:a.isDay||a.isDays||a.isWeek||a.isMonth,[`vuecal__cell--${Ie[$]}`]:a.isYear,[`vuecal__cell--${i}`]:a.isYears,"vuecal__cell--today":t.value,"vuecal__cell--current-month":a.isYear&&i===e.getFullYear()&&$===e.getMonth(),"vuecal__cell--current-year":a.isYears&&i===e.getFullYear(),"vuecal__cell--out-of-range":a.isMonth&&(i!==r||$!==v),"vuecal__cell--before-min":ge.value&&se.value,"vuecal__cell--after-max":ge.value&&Z.value,"vuecal__cell--disabled":ge.value,"vuecal__cell--selected":a.selectedDate&&a.selectedDate.getTime()>=b.start.getTime()&&a.selectedDate.getTime()<=b.end.getTime(),"vuecal__cell--has-schedules":(A=o.schedules)==null?void 0:A.length,"vuecal__cell--dragging":n.dragging,"vuecal__cell--has-events":c.value.length}}),de=k(()=>y.formatDate(b.start)),h=k(()=>{switch(a.id){case"day":return"";case"days":return o.availableViews.days.rows>1&&y.formatDate(b.start,"D"),"";case"week":return"";case"month":return y.formatDate(b.start,"D");case"year":return y.formatDate(b.start,o.xs?"MMM":"MMMM");case"years":return y.formatDate(b.start,"YYYY")}}),c=k(()=>o.datePicker?[]:Y.getEventsByDate(de.value,!0,!0).filter(e=>!w.value.includes(e._.id))),T=k(()=>c.value.filter(e=>!e.background)),M=k(()=>{var e;return(e=o.schedules)==null?void 0:e.reduce((r,v)=>(r[v.id]=c.value.filter(i=>i.schedule===v.id),r),{})}),z=k(()=>{const e={};for(const r of c.value){const v=r._.id,{maxConcurrent:i=1,position:$=0}=W.value.cellOverlaps[v]||{};e[v]={left:`${100/i*$}%`},o.stackEvents?e[v].width=`${100/i+($===i-1?0:15)}%`:e[v].width=`${100/i}%`}return e}),L=k(()=>{const e={};for(const r of c.value){const v=r._.id,{maxConcurrent:i=1,position:$=0}=W.value.cellOverlaps[v]||{};e[v]=`vuecal__event--stack-${$+1}-${i}`}return e}),N=k(()=>a.isMonth&&o.eventCount&&!o.eventsOnMonthView&&T.value.length),q=k(()=>{var v;if(!o.specialHours||a.isMonth||a.isYear||a.isYears)return;const e=pe[b.start.getDay()];let r=(v=o.specialHours)==null?void 0:v[e];if(r)return Array.isArray(r)||(r=[r]),r.map(i=>{let{from:$,to:E,class:A,label:J}=i;if(isNaN($)||isNaN(E)||o.timeFrom>=E||o.timeTo<=$)return;$=Math.max(o.timeFrom,$),E=Math.min(o.timeTo,E);const ae=ne($,o),Xe=ne(E,o)-ae;return{style:{top:`${ae}%`,height:`${Xe}%`},label:J,class:A}}).filter(i=>!!i)}),se=k(()=>o.minTimestamp!==null&&o.minTimestamp>b.end.getTime()),Z=k(()=>o.maxTimestamp&&o.maxTimestamp<b.start.getTime()),ge=k(()=>{const{disableDays:e}=o,r=a.isYear||a.isYears;return e.length&&e.includes(y.formatDate(b.start))&&!r?!0:se.value||Z.value}),ue=he({show:k(()=>{if(!(!a.isDay&&!a.isDays&&!a.isWeek)&&!(!t.value||!o.time)&&!(o.timeFrom>y.dateToMinutes(a.now))&&!(y.dateToMinutes(a.now)>o.timeTo))return!0}),nowInMinutes:k(()=>y.dateToMinutes(a.now)),todaysTimePosition:k(()=>ne(ue.nowInMinutes,o)),style:k(()=>`top: ${ue.todaysTimePosition}%`),currentTime:k(()=>y.formatTime(a.now))}),le=k(()=>{if(ge.value)return{};const e={...o.eventListeners.cell};for(const[i,$]of Object.entries(e))e[i]=E=>{var A,J,ae;(ae=(J=E.target||((A=E.e)==null?void 0:A.target)).closest)!=null&&ae.call(J,".vuecal__event")||$(E.type?{e:E,cell:S.value,cursor:x.value}:E)};const r={...e};let v=null;return e.click=i=>{var E;ze();const $=we(i);(E=r.click)==null||E.call(r,{e:i,cell:S.value,cursor:$}),v?v=clearTimeout(v):v=setTimeout(()=>{var A;v=null,(A=r["delayed-click"])==null||A.call(r,{e:i,cell:S.value,cursor:$})},400)},(o.time&&a.isDay||a.isDays||a.isWeek)&&(e.touchstart=i=>{var $;be(i.e||i),($=r.touchstart)==null||$.call(r,{e:i,cell:S.value,cursor:x.value})},e.mousedown=i=>{var $;be(i.e||i),($=r.mousedown)==null||$.call(r,{e:i,cell:S.value,cursor:x.value})}),r.dblclick&&(e.dblclick=i=>{var $;($=r.dblclick)==null||$.call(r,{e:i,cell:S.value,cursor:we(i)})}),o.editableEvents.drag&&(e.dragenter=i=>m.cellDragEnter(i,S.value),e.dragover=i=>{i.preventDefault(),m.cellDragOver(i,S.value)},e.dragleave=i=>m.cellDragLeave(i,S.value),e.drop=i=>m.cellDragDrop(i,S.value)),e}),S=k(()=>({start:b.start,end:b.end,events:c,...n.schedule?{schedule:n.schedule}:{},goNarrower:()=>a.narrower(),goBroader:()=>a.broader(),broader:a.broaderView,narrower:a.narrowerView})),we=e=>{var E;const r=(((E=e.touches)==null?void 0:E[0])||e).clientY,{top:v}=s.value.getBoundingClientRect(),i=Ce(r-v,s.value),$=new Date(b.start);return $.setMinutes(ce(i,o)),{y:i,date:$}},x=k(()=>{const e=ce(n.movePercentageY||n.startPercentageY,o),r=new Date(b.start);return r.setMinutes(e),{x:n.movePercentageX||n.startPercentageX,y:n.movePercentageY||n.startPercentageY,date:r}}),ze=()=>{a.updateSelectedDate(b.start),o.clickToNavigate&&((a.isMonth||a.isDays||a.isWeek)&&o.availableViews.day?a.switch("day"):a.isYear&&o.availableViews.month?a.switch("month"):a.isYears&&o.availableViews.year&&a.switch("year")),a.updateViewDate(b.start)},be=e=>{var v,i;n.schedule=~~e.target.dataset.schedule;const r=s.value.getBoundingClientRect();n.startX=(((v=e.touches)==null?void 0:v[0])||e).clientX-r.left,n.startY=(((i=e.touches)==null?void 0:i[0])||e).clientY-r.top,n.startPercentageX=n.startX*100/r.width,n.startPercentageY=n.startY*100/r.height,n.thresholdPassed=!1,document.addEventListener(e.type==="touchstart"?"touchmove":"mousemove",De),document.addEventListener(e.type==="touchstart"?"touchend":"mouseup",Le,{once:!0}),n.holdTimer=setTimeout(()=>{var $,E;n.holding=!0,(E=($=le.value).hold)==null||E.call($,{e,cell:S.value,cursor:x.value})},1e3)},De=e=>{var v,i,$,E,A,J;n.dragging||(D.isDraggingCell=!0,(i=(v=le.value).dragStart)==null||i.call(v,{e,cell:S.value,cursor:x.value})),n.dragging=!0,n.holdTimer=clearTimeout(n.holdTimer),n.holding=!1;const r=s.value.getBoundingClientRect();n.moveX=((($=e.touches)==null?void 0:$[0])||e).clientX-r.left,n.moveY=(((E=e.touches)==null?void 0:E[0])||e).clientY-r.top,n.movePercentageX=n.moveX*100/r.width,n.movePercentageY=n.moveY*100/r.height,o.eventCreateMinDrag&&Math.abs(n.startY-n.moveY)>o.eventCreateMinDrag&&(n.thresholdPassed=!0),(J=(A=le.value).drag)==null||J.call(A,{e,cell:S.value,cursor:x.value})},Le=async e=>{var r,v;document.removeEventListener(e.type==="touchend"?"touchmove":"mousemove",De,{passive:!1}),n.dragging&&((v=(r=le.value)["drag-end"])==null||v.call(r,{e,cell:S.value,cursor:x.value}),D.isDraggingCell=!1,o.editableEvents.create&&(d.value=!0,await Se(e),d.value=!1)),n.holdTimer=clearTimeout(n.holdTimer),n.holding=!1,n.dragging=!1,n.startX=0,n.startY=0,n.moveX=0,n.moveY=0,n.startPercentageX=0,n.startPercentageY=0,n.movePercentageX=0,n.movePercentageY=0,n.thresholdPassed=!1,n.schedule=null},Se=async e=>{if(!ie.value)return;let{start:r,end:v,startMinutes:i,endMinutes:$}=p.value;r=new Date(b.start),r.setMinutes(i),v=new Date(b.start),v.setMinutes($);let E={...p.value,start:r,end:v};const{create:A}=o.eventListeners.event;if(typeof A=="function"){const J=E;E=await new Promise(ae=>A({e,event:E,cell:S.value,resolve:ae,cursor:x.value})),E&&typeof E=="object"&&a.createEvent(E),E&&typeof E=="boolean"&&a.createEvent(J)}else a.createEvent(E)},Be=()=>{var e;for(const r of Object.keys(le.value))(e=s.value)==null||e.removeEventListener(r,le.value[r])},Oe=()=>{W.value=Y.getCellOverlappingEvents(de.value)};return Ne(()=>T.value.map(e=>`${e._.id}${e.start.getTime()}${e.end.getTime()}`).join(),async()=>{await _e(),Oe()},{immediate:!0,flush:"post"}),$e(async()=>{for(const e of w.value)Y.deleteEvent(e,3);Be(),await _e()}),(e,r)=>(u(),f("div",j({class:["vuecal__cell",me.value],ref_key:"cellEl",ref:s},fe(le.value,!0)),[e.$slots.cell?_(e.$slots,"cell",{key:0,cell:S.value}):P("",!0),q.value?(u(!0),f(X,{key:1},K(q.value,(v,i)=>(u(),f("div",{class:U(["vuecal__special-hours",v.class]),style:G(v.style),innerHTML:v.label||""},null,14,gt))),256)):P("",!0),!e.$slots.cell&&g(o).schedules?(u(!0),f(X,{key:2},K(g(o).schedules,v=>(u(),f("div",{class:U(["vuecal__schedule vuecal__schedule--cell",v.class]),key:v.id,style:G(v.style||null),"data-schedule":v.id},[e.$slots["cell-events"]?_(e.$slots,"cell-events",{key:0,cell:S.value}):P("",!0),h.value||e.$slots["cell-date"]?(u(),f("div",ht,[_(e.$slots,"cell-date",{cell:S.value},()=>[Ee(R(h.value),1)])])):P("",!0),e.$slots["cell-content"]?(u(),f("div",yt,[_(e.$slots,"cell-content",{cell:S.value})])):P("",!0),e.$slots["cell-events"]&&c.value.length?(u(),f("div",_t,[_(e.$slots,"cell-events",{cell:S.value})])):c.value.length||B.value?(u(),te(Ye,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:r[0]||(r[0]=i=>B.value=!0),onAfterLeave:I,tag:"div"},{default:C(()=>[(u(!0),f(X,null,K(M.value[v.id],i=>(u(),te(Pe,{key:i._.id,event:i,onEventDeleted:O,style:G(z.value[i._.id])},re({_:2},[e.$slots.event?{name:"event",fn:C($=>[_(e.$slots,"event",j({ref_for:!0},$))]),key:"0"}:void 0]),1032,["event","style"]))),128))]),_:2},1024)):P("",!0),ie.value&&n.schedule===v.id?(u(),f("div",{key:5,class:"vuecal__event-placeholder",style:G(p.value.style)},R(p.value.start)+" - "+R(p.value.end),5)):P("",!0)],14,ft))),128)):P("",!0),!e.$slots.cell&&!g(o).schedules?(u(),f(X,{key:3},[e.$slots["cell-events"]?_(e.$slots,"cell-events",{key:0,cell:S.value}):P("",!0),h.value||e.$slots["cell-date"]?(u(),f("div",pt,[_(e.$slots,"cell-date",{cell:S.value},()=>[Ee(R(h.value),1)])])):P("",!0),e.$slots["cell-content"]?(u(),f("div",kt,[_(e.$slots,"cell-content",{cell:S.value})])):P("",!0),e.$slots["cell-events"]&&c.value.length?(u(),f("div",$t,[_(e.$slots,"cell-events",{cell:S.value})])):(c.value.length||B.value)&&!(g(a).isMonth&&!g(o).eventsOnMonthView)?(u(),te(Ye,{key:4,class:"vuecal__cell-events",name:"vuecal-event-delete",onBeforeLeave:r[1]||(r[1]=v=>B.value=!0),onAfterLeave:I,tag:"div"},{default:C(()=>[(u(!0),f(X,null,K(c.value,v=>(u(),te(Pe,{key:v._.id,event:v,onEventDeleted:O,class:U(L.value[v._.id]),style:G(z.value[v._.id])},re({_:2},[e.$slots.event?{name:"event",fn:C(i=>[_(e.$slots,"event",j({ref_for:!0},i))]),key:"0"}:void 0]),1032,["event","class","style"]))),128))]),_:3})):P("",!0),ie.value?(u(),f("div",{key:5,class:"vuecal__event-placeholder",style:G(p.value.style)},R(p.value.start)+" - "+R(p.value.end),5)):P("",!0)],64)):P("",!0),e.$slots["event-count"]?_(e.$slots,"event-count",{key:4,events:T.value}):N.value?(u(),f("div",wt,R(T.value.length),1)):P("",!0),ue.show?(u(),f("div",{key:6,class:"vuecal__now-line",style:G(ue.style),title:ue.currentTime},[H("span",null,R(ue.currentTime),1)],12,bt)):P("",!0)],16))}},Tt={__name:"body",setup(Q){const b=ve("vuecal"),{view:l,config:a,dateUtils:o}=b,y=ee(null),Y=ee(null),m=k(()=>({"--vuecal-grid-columns":l.cols,"--vuecal-grid-rows":l.rows})),D=k(()=>{const w=o.formatTime(ce(Y.value,a));return{style:{top:`${Y.value}%`},time:w}}),t=w=>{var I;if(l.isMonth||l.isYear||l.isYears)return;const B=(((I=w.touches)==null?void 0:I[0])||w).clientY,{top:O}=y.value.getBoundingClientRect();Y.value=Ce(B-O,y.value)},s=()=>{Y.value=null};return ke(()=>{y.value.addEventListener("mousemove",t),y.value.addEventListener("touchmove",t),y.value.addEventListener("mouseleave",s),y.value.addEventListener("touchend",s)}),$e(()=>{y.value&&(y.value.removeEventListener("mousemove",t),y.value.removeEventListener("touchmove",t),y.value.removeEventListener("mouseleave",s),y.value.removeEventListener("touchend",s))}),(w,B)=>(u(),f("div",{class:"vuecal__body",ref_key:"bodyEl",ref:y,style:G(m.value)},[oe(ye,{name:"vuecal-shrink"},{default:C(()=>[g(a).timeAtCursor&&Y.value!==null?(u(),f("div",{key:0,class:"vuecal__time-at-cursor",style:G(D.value.style)},[H("label",null,R(D.value.time),1)],4)):P("",!0)]),_:1}),(u(!0),f(X,null,K(g(l).cellDates,(O,I)=>(u(),te(Dt,{key:I,start:O.start,end:O.end,index:I},re({_:2},[w.$slots.cell?{name:"cell",fn:C(n=>[_(w.$slots,"cell",j({ref_for:!0},n))]),key:"0"}:void 0,w.$slots["cell-date"]?{name:"cell-date",fn:C(n=>[_(w.$slots,"cell-date",j({ref_for:!0},n))]),key:"1"}:void 0,w.$slots["cell-content"]?{name:"cell-content",fn:C(n=>[_(w.$slots,"cell-content",j({ref_for:!0},n))]),key:"2"}:void 0,w.$slots["cell-events"]?{name:"cell-events",fn:C(n=>[_(w.$slots,"cell-events",j({ref_for:!0},n))]),key:"3"}:w.$slots.event?{name:"event",fn:C(n=>[_(w.$slots,"event",j({ref_for:!0},n))]),key:"4"}:w.$slots["event-count"]?{name:"event-count",fn:C(n=>[_(w.$slots,"event-count",j({ref_for:!0},n))]),key:"5"}:void 0]),1032,["start","end","index"]))),128))],4))}},Mt=["data-locale"],Et={class:"vuecal__scrollable-wrap"},Yt={key:1,class:"vuecal__week-numbers"},Pt={class:"vuecal__week-number"},Ct={class:"vuecal__body-wrap"},St={__name:"index",props:je,emits:["ready","view-change","update:view","update:selectedDate","update:viewDate","update:events","event-delete","event-created","event-dropped"],setup(Q,{expose:b,emit:l}){const a=Q,o=l,y=Ae("vuecal-el"),Y=He({props:a,emit:o,attrs:Fe(),vuecalEl:y,uid:Ve()}),{config:m,view:D,dateUtils:t,touch:s}=Y,w=k(()=>m.time&&(D.isDay||D.isDays||D.isWeek)),B=k(()=>Array(D.rows).fill().map((d,W)=>t.getWeek(t.addDays(D.firstCellDate,7*W)))),O=k(()=>{var d;return{"vuecal--ready":m.ready,[`vuecal--${m.theme}-theme`]:m.theme,[`vuecal--${m.size}`]:!0,"vuecal--date-picker":m.datePicker,"vuecal--dark":m.dark,"vuecal--light":!m.dark,[`vuecal--${D.id}-view`]:!0,"vuecal--view-has-time":w.value,"vuecal--timeless":!m.time,"vuecal--dragging-cell":s.isDraggingCell,"vuecal--dragging-event":s.isDraggingEvent,"vuecal--resizing-event":s.isResizingEvent,"vuecal--has-schedules":(d=m.schedules)==null?void 0:d.length}}),I=k(()=>({"--vuecal-time-cell-height":m.timeCellHeight&&`${m.timeCellHeight}px`})),n=k(()=>{var d,W;return{"vuecal__scrollable--row":w.value||m.weekNumbers&&D.isMonth,[`vuecal__scrollable--${D.id}-view`]:!0,"vuecal__scrollable--has-schedules":(d=m.schedules)==null?void 0:d.length,"vuecal__scrollable--no-schedules":!((W=m.schedules)!=null&&W.length)}});return ke(async()=>{await _e(),m.ready=!0,o("ready",{config:m,view:D})}),Re("vuecal",Y),b({view:Y.view}),(d,W)=>(u(),f("div",{class:U(["vuecal",O.value]),ref:"vuecal-el","data-locale":d.locale,style:G(I.value)},[d.$slots.diy?_(d.$slots,"diy",{key:0,vuecal:g(Y)}):(u(),f(X,{key:1},[oe(Ze,null,re({_:2},[d.$slots.header?{name:"header",fn:C(p=>[_(d.$slots,"header",V(F(p)))]),key:"0"}:void 0,!d.$slots.header&&d.$slots["previous-button"]?{name:"previous-button",fn:C(p=>[_(d.$slots,"previous-button",V(F(p)))]),key:"1"}:void 0,!d.$slots.header&&d.$slots["next-button"]?{name:"next-button",fn:C(p=>[_(d.$slots,"next-button",V(F(p)))]),key:"2"}:void 0,!d.$slots.header&&d.$slots["today-button"]?{name:"today-button",fn:C(p=>[_(d.$slots,"today-button",V(F(p)))]),key:"3"}:void 0,!d.$slots.header&&d.$slots.title?{name:"title",fn:C(p=>[_(d.$slots,"title",V(F(p)))]),key:"4"}:void 0,!d.$slots.header&&d.$slots["schedule-heading"]?{name:"schedule-heading",fn:C(p=>[_(d.$slots,"schedule-heading",V(F(p)))]),key:"5"}:void 0]),1024),H("div",Et,[oe(ye,{name:`vuecal-slide-fade--${g(D).transitionDirection}`},{default:C(()=>[(u(),f("div",{class:U(["vuecal__scrollable",n.value]),key:g(D).id+g(D).start.getTime()},[w.value?(u(),te(it,{key:0},re({_:2},[d.$slots["time-cell"]?{name:"time-cell",fn:C(p=>[_(d.$slots,"time-cell",V(F(p)))]),key:"0"}:void 0]),1024)):P("",!0),g(m).weekNumbers&&g(D).isMonth?(u(),f("div",Yt,[(u(!0),f(X,null,K(B.value,p=>(u(),f("div",Pt,[_(d.$slots,"week-number",{},()=>[H("small",null,R(p),1)])]))),256))])):P("",!0),H("div",Ct,[oe(ot,null,re({_:2},[d.$slots["weekday-heading"]?{name:"weekday-heading",fn:C(p=>[_(d.$slots,"weekday-heading",V(F(p)))]),key:"0"}:void 0,d.$slots["schedule-heading"]?{name:"schedule-heading",fn:C(p=>[_(d.$slots,"schedule-heading",V(F(p)))]),key:"1"}:void 0]),1024),oe(Tt,null,re({_:2},[d.$slots.cell?{name:"cell",fn:C(p=>[_(d.$slots,"cell",V(F(p)))]),key:"0"}:void 0,!d.$slots.cell&&d.$slots["cell-date"]?{name:"cell-date",fn:C(p=>[_(d.$slots,"cell-date",V(F(p)))]),key:"1"}:void 0,!d.$slots.cell&&d.$slots["cell-content"]?{name:"cell-content",fn:C(p=>[_(d.$slots,"cell-content",V(F(p)))]),key:"2"}:void 0,!d.$slots.cell&&d.$slots["cell-events"]?{name:"cell-events",fn:C(p=>[_(d.$slots,"cell-events",V(F(p)))]),key:"3"}:void 0,!d.$slots.cell&&d.$slots.event?{name:"event",fn:C(p=>[_(d.$slots,"event",V(F(p)))]),key:"4"}:void 0,!d.$slots.cell&&d.$slots["event-count"]?{name:"event-count",fn:C(p=>[_(d.$slots,"event-count",V(F(p)))]),key:"5"}:void 0]),1024)])],2))]),_:3},8,["name"])])],64))],14,Mt))}};export{St as _};
